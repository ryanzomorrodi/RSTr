<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>03: The CAR Models • RSTr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="03: The CAR Models">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RSTr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/RSTr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/RSTr-event.html">01: Understanding and Preparing Your Event Data</a></li>
    <li><a class="dropdown-item" href="../articles/RSTr-adjacency.html">02: Understanding and Preparing Your Adjacency Structure</a></li>
    <li><a class="dropdown-item" href="../articles/RSTr-car.html">03: The CAR Models</a></li>
    <li><a class="dropdown-item" href="../articles/RSTr-agestandardize.html">04: Generating Estimates: Age-standardization</a></li>
    <li><a class="dropdown-item" href="../articles/RSTr-reliability.html">05: Generating Estimates: Reliability and Suppression</a></li>
    <li><a class="dropdown-item" href="../articles/RSTr-informativeness.html">06: Model Informativeness</a></li>
    <li><a class="dropdown-item" href="../articles/RSTr-samples.html">07: Sample Processing</a></li>
    <li><a class="dropdown-item" href="../articles/RSTr-initialvalues.html">08: Initial Values</a></li>
    <li><a class="dropdown-item" href="../articles/RSTr-priors.html">09: Priors</a></li>
    <li><a class="dropdown-item" href="../articles/RSTr-models.html">Appendix A: The CAR Hierarchical Models</a></li>
    <li><a class="dropdown-item" href="../articles/RSTr-troubleshoot.html">Appendix B: Troubleshooting</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>03: The CAR Models</h1>
            
      

      <div class="d-none name"><code>RSTr-car.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <code>*car()</code> functions (<code><a href="../reference/ucar.html">eucar()</a></code>,
<code><a href="../reference/ucar.html">ucar()</a></code>, <code><a href="../reference/ucar.html">mcar()</a></code>, <code><a href="../reference/ucar.html">mstcar()</a></code>) build
the necessary features needed to run <code>RSTr</code> and places them
in the specified directory. In this vignette, we will talk in detail
about each model, the arguments used in <code>*car()</code> functions,
and how to use them.</p>
</div>
<div class="section level2">
<h2 id="the-car-functions">The <code>*car()</code> functions<a class="anchor" aria-label="anchor" href="#the-car-functions"></a>
</h2>
<p>The current version of <code>RSTr</code> features four models to
choose from: the Univariate CAR (UCAR), also known as the
Besag-York-Mollié (BYM) model, the Enhanced UCAR (EUCAR) model, the
Multivariate CAR (MCAR) model, and the Multivariate Spatiotemporal CAR
(MSTCAR) model. We will now compare these models and their use
cases.</p>
<div class="section level3">
<h3 id="the-ucar-model">The UCAR model<a class="anchor" aria-label="anchor" href="#the-ucar-model"></a>
</h3>
<p>The UCAR model (function call <code><a href="../reference/ucar.html">ucar()</a></code>) is the basis of
all models used in <code>RSTr</code>. The premise of the UCAR is to
spatially smooth estimates across spatial regions using a random effects
estimator <code>Z</code>. The intensity of its smoothing in a region is
based on the event and population counts of that region and the counts
in its neighboring regions.</p>
<p>The UCAR model only smooths across spatial regions and not across
sociodemographic groups or time periods. While datasets that include
these stratifications can be run with <code><a href="../reference/ucar.html">ucar()</a></code>, the user
would be effectively running several concurrent UCAR models. The UCAR
model is recommended if the user is only has data for one
sociodemographic group of interest and one time-period.</p>
</div>
<div class="section level3">
<h3 id="the-eucar-model">The EUCAR model<a class="anchor" aria-label="anchor" href="#the-eucar-model"></a>
</h3>
<p>The EUCAR model (function call <code><a href="../reference/ucar.html">eucar()</a></code>) is the most
recent BYM implementation in <code>RSTr</code>. The EUCAR model follows
the same general paradigm as the UCAR model, but prevents oversmoothing
by capping the spatial and non-spatial variance. Even though the EUCAR
only smooths across spatial regions, the estimates generated by
<code><a href="../reference/ucar.html">eucar()</a></code> are nuanced and strike a happy medium between the
use of crude rate estimates and the oversmoothing of the standard UCAR
model.</p>
</div>
<div class="section level3">
<h3 id="the-mcar-model">The MCAR model<a class="anchor" aria-label="anchor" href="#the-mcar-model"></a>
</h3>
<p>The MCAR model (function call <code><a href="../reference/ucar.html">mcar()</a></code>) is an extension of
the UCAR model: whereas the UCAR model can only smooth over spatial
regions, the MCAR model can smooth over spatial regions and
sociodemographic groups. The MCAR model is ideal for datasets that
include multiple sociodemographic groups. An Enhanced MCAR (EMCAR) model
is currently under development and will be implemented in
<code>RSTr</code> once its methodology is finalized.</p>
</div>
<div class="section level3">
<h3 id="the-mstcar-model">The MSTCAR model<a class="anchor" aria-label="anchor" href="#the-mstcar-model"></a>
</h3>
<p>The MSTCAR model (function call <code><a href="../reference/ucar.html">mstcar()</a></code>) is an
extension of the MCAR model, allowing for smoothing over spatial
regions, sociodemographic groups, and time periods. The MSTCAR model is
ideal for investigating trends in rate estimates over a specified time
period.</p>
</div>
</div>
<div class="section level2">
<h2 id="arguments-of-the-car-function">Arguments of the <code>*car()</code> function<a class="anchor" aria-label="anchor" href="#arguments-of-the-car-function"></a>
</h2>
<p>All <code>*car()</code> functions provide several arguments:</p>
<ul>
<li><p><code>name</code>: The name of the folder your model information
lives in;</p></li>
<li><p><code>data</code>: The <code>list</code> object containing the
event <code>Y</code> and population <code>n</code> data. For more
information on <code>data</code> setup, read
<code><a href="../articles/RSTr-event.html">vignette("RSTr-event")</a></code>;</p></li>
<li><p><code>adjacency</code>: The adjacency structure for your event
and population data. For more information on adjacency structure setup,
read <code><a href="../articles/RSTr-adjacency.html">vignette("RSTr-adjacency")</a></code>;</p></li>
<li><p><code>dir</code>: The directory where the model folder lives. By
default, this saves into your temporary directory, so the model
information will be lost after the R session ends. Should you want to
save your model to be analyzed at a later date or ensure that your
samples are intact if R crashes during runtime, specify a different
directory;</p></li>
<li><p><code>seed</code>: Allows the user to specify the random seed
used for replication purposes;</p></li>
<li><p><code>perc_ci</code>: A number between 0 and 1 which specifies
the desired credible interval to use when calculating the relative
precision of estimates. By default, set to 0.95;</p></li>
<li><p><code>iterations</code>: The number of iterations to run the
model for;</p></li>
<li><p><code>show_plots</code>: If set to <code>FALSE</code>, hides
traceplots during model execution;</p></li>
<li><p><code>verbose</code>: If set to <code>FALSE</code>, hides the
progress bar and messages in the console;</p></li>
<li><p><code>ignore_checks</code>: If set to <code>TRUE</code>, skips
model validation;</p></li>
<li><p><code>method</code>: Chooses whether the event data is either
Binomial (<code>"binomial"</code>) or Poisson (<code>"poisson"</code>)
distributed. By default, <code>RSTr</code> uses Binomial updates for
event data;</p></li>
<li><p><code>impute_lb</code>: Specifies a lower bound for imputed data
for event information that is missing or suppressed;</p></li>
<li><p><code>impute_ub</code>: Specifies an upper bound for imputed data
for event information that is missing or suppressed;</p></li>
<li><p><code>initial_values</code>: This is a <code>list</code> of
initial values for each parameter. This can be specified by the user or
generated by default. For more information on specification of
<code>initial_values</code>, see
<code><a href="../articles/RSTr-initialvalues.html">vignette("RSTr-initialvalues")</a></code>; and</p></li>
<li><p><code>priors</code>: This is a <code>list</code> of all prior
information for each parameter. This can be specified by the user or
generated by default. For more information on specification of
<code>priors</code>, see <code><a href="../articles/RSTr-priors.html">vignette("RSTr-priors")</a></code>.</p></li>
</ul>
<p>Most of these arguments are not needed, as the model has defaults for
many of them. <code><a href="../reference/ucar.html">eucar()</a></code> and <code><a href="../reference/ucar.html">mstcar()</a></code> have
additional arguments only used by them:</p>
<ul>
<li><p><code>A</code>: In the EUCAR model, describes the limit of the
smoothing intensity between regions;</p></li>
<li><p><code>m0</code>: In the EUCAR model, specifies the baseline
neighbor count; and</p></li>
<li><p><code>update_rho</code>: In the MSTCAR model, allows for updates
of the temporal correlation parameter <code>rho</code>. By default,
<code>RSTr</code> does not update <code>rho</code>.</p></li>
</ul>
<p>If you run into errors when trying to initialize your model, read
<code><a href="../articles/RSTr-troubleshoot.html">vignette("RSTr-troubleshoot")</a></code>. Below, we will go into
detail regarding what each argument does specifically and what to keep
in mind when setting these values.</p>
<div class="section level3">
<h3 id="the-initial_values-argument">The <code>initial_values</code> argument<a class="anchor" aria-label="anchor" href="#the-initial_values-argument"></a>
</h3>
<p><code>initial_values</code> is a <code>list</code> specifying the
starting values for parameters in the model. Details around the initial
value parameters can be found in
<code><a href="../articles/RSTr-initialvalues.html">vignette("RSTr-initialvalues")</a></code>.</p>
</div>
<div class="section level3">
<h3 id="the-priors-argument">The <code>priors</code> argument<a class="anchor" aria-label="anchor" href="#the-priors-argument"></a>
</h3>
<p><code>priors</code> behaves similar to <code>initial_values</code>,
except that it contains all information related to parameter priors.
Details around the initial value parameters can be found in
<code><a href="../articles/RSTr-priors.html">vignette("RSTr-priors")</a></code>.</p>
</div>
<div class="section level3">
<h3 id="the-method-argument">The <code>method</code> argument<a class="anchor" aria-label="anchor" href="#the-method-argument"></a>
</h3>
<p><code>method</code> offers two values: <code>"binomial"</code> and
<code>"poisson"</code>. These values determine how the data is
transformed and how the <code>lambda</code> Metropolis update is
performed: <code>"binomial"</code> treats the event data as
Binomial-distributed and <code>"poisson"</code> treats the event data as
Poisson-distributed. Depending on your use case, you’ll want to choose
between the two: for example, if you are working with very small
mortality rates, <code>"poisson"</code> will work well, but if you are
working with birth rates, for example, then <code>"binomial"</code> will
work better. Note that <code>"binomial"</code> works in most general use
cases and <code>"poisson"</code> only works well for datasets with small
rates under approximately 1%.</p>
</div>
<div class="section level3">
<h3 id="m0-and-a">
<code>m0</code> and <code>A</code><a class="anchor" aria-label="anchor" href="#m0-and-a"></a>
</h3>
<p><code>m0</code> and <code>A</code> are two components that determine
the intensity of the smoothing of Enhanced CAR models. <code>m0</code>
should be a positive scalar, and the size of <code>A</code> is dependent
on the group/time structure of your data: <code>A</code> will be a
positive scalar for region-only models, a <code>vector</code> of size
<code>num_group</code> for region-group models, and a matrix of size
<code>num_group</code> x <code>num_time</code> for region-group-time
models. Note, however, that these informativeness restriction measures
are currently only developed for the UCAR model, and restrictions for
more complex models will be added to the <code>RSTr</code> package as
their respective methods are developed.</p>
</div>
<div class="section level3">
<h3 id="the-update_rho-argument">The <code>update_rho</code> argument<a class="anchor" aria-label="anchor" href="#the-update_rho-argument"></a>
</h3>
<p>In the MSTCAR model, <code>update_rho</code> is a
<code>logical</code> that specifies whether to calculate estimates for
the temporal correlation <code>rho</code>. By default, it is set to
<code>FALSE</code>. In empirical testing, this estimate was found to not
be very sensitive to changes when specified prudently and also increases
runtime by an order of magnitude due to its complexity.</p>
</div>
<div class="section level3">
<h3 id="the-seed-argument">The <code>seed</code> argument<a class="anchor" aria-label="anchor" href="#the-seed-argument"></a>
</h3>
<p>Because of the stochastic nature of Bayesian inference and the
inherent instability of the MSTCAR model, replicability is extremely
important. <code>seed</code> allows the user to specify a seed for
generating similar estimates.</p>
</div>
<div class="section level3">
<h3 id="the-ignore_checks-argument">The <code>ignore_checks</code> argument<a class="anchor" aria-label="anchor" href="#the-ignore_checks-argument"></a>
</h3>
<p>As development continues on <code>RSTr</code>, there are occasions
where the checks performed on the inputs of <code>*car()</code> throw an
error, even though you may be certain that all of your inputs are
behaving as expected. To override the checks, you can use the
<code>ignore_checks</code> argument. Set this to <code>TRUE</code> to
skip this step.</p>
</div>
</div>
<div class="section level2">
<h2 id="closing-thoughts">Closing Thoughts<a class="anchor" aria-label="anchor" href="#closing-thoughts"></a>
</h2>
<p>Initialization is one of the most important steps of running the
model, as it’s where virtually all choices regarding the model are made.
In this vignette, we explored each available type of CAR model in
<code>RSTr</code>, the arguments of the <code>*car()</code> functions,
and how to appropriately choose values for each argument.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by David DeLara, Centers for Disease Control and Prevention.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
