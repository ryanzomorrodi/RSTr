[{"path":"/DISCLAIMER.html","id":null,"dir":"","previous_headings":"","what":"DISCLAIMER","title":"DISCLAIMER","text":"Use service limited non-sensitive publicly available data. Users must use, share, store kind sensitive data like health status, provision payment healthcare, Personally Identifiable Information (PII) /Protected Health Information (PHI), etc. circumstance. Administrators service reserve right moderate information used, shared, stored service time. user abide disclaimer Code Conduct may subject action, including revoking access services. material embodied software provided “-” without warranty kind, express, implied otherwise, including without limitation, warranty fitness particular purpose. event shall Centers Disease Control Prevention (CDC) United States (U.S.) government liable anyone else direct, special, incidental, indirect consequential damages kind, damages whatsoever, including without limitation, loss profit, loss use, savings revenue, claims third parties, whether CDC U.S. government advised possibility loss, however caused theory liability, arising connection possession, use performance software.","code":""},{"path":"/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"GNU General Public License","title":"GNU General Public License","text":"Version 3, 29 June 2007Copyright © 2007 Free Software Foundation, Inc. <http://fsf.org/> Everyone permitted copy distribute verbatim copies license document, changing allowed.","code":""},{"path":"/LICENSE.html","id":"preamble","dir":"","previous_headings":"","what":"Preamble","title":"GNU General Public License","text":"GNU General Public License free, copyleft license software kinds works. licenses software practical works designed take away freedom share change works. contrast, GNU General Public License intended guarantee freedom share change versions program–make sure remains free software users. , Free Software Foundation, use GNU General Public License software; applies also work released way authors. can apply programs, . speak free software, referring freedom, price. General Public Licenses designed make sure freedom distribute copies free software (charge wish), receive source code can get want , can change software use pieces new free programs, know can things. protect rights, need prevent others denying rights asking surrender rights. Therefore, certain responsibilities distribute copies software, modify : responsibilities respect freedom others. example, distribute copies program, whether gratis fee, must pass recipients freedoms received. must make sure , , receive can get source code. must show terms know rights. Developers use GNU GPL protect rights two steps: (1) assert copyright software, (2) offer License giving legal permission copy, distribute /modify . developers’ authors’ protection, GPL clearly explains warranty free software. users’ authors’ sake, GPL requires modified versions marked changed, problems attributed erroneously authors previous versions. devices designed deny users access install run modified versions software inside , although manufacturer can . fundamentally incompatible aim protecting users’ freedom change software. systematic pattern abuse occurs area products individuals use, precisely unacceptable. Therefore, designed version GPL prohibit practice products. problems arise substantially domains, stand ready extend provision domains future versions GPL, needed protect freedom users. Finally, every program threatened constantly software patents. States allow patents restrict development use software general-purpose computers, , wish avoid special danger patents applied free program make effectively proprietary. prevent , GPL assures patents used render program non-free. precise terms conditions copying, distribution modification follow.","code":""},{"path":[]},{"path":"/LICENSE.html","id":"id_0-definitions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"0. Definitions","title":"GNU General Public License","text":"“License” refers version 3 GNU General Public License. “Copyright” also means copyright-like laws apply kinds works, semiconductor masks. “Program” refers copyrightable work licensed License. licensee addressed “”. “Licensees” “recipients” may individuals organizations. “modify” work means copy adapt part work fashion requiring copyright permission, making exact copy. resulting work called “modified version” earlier work work “based ” earlier work. “covered work” means either unmodified Program work based Program. “propagate” work means anything , without permission, make directly secondarily liable infringement applicable copyright law, except executing computer modifying private copy. Propagation includes copying, distribution (without modification), making available public, countries activities well. “convey” work means kind propagation enables parties make receive copies. Mere interaction user computer network, transfer copy, conveying. interactive user interface displays “Appropriate Legal Notices” extent includes convenient prominently visible feature (1) displays appropriate copyright notice, (2) tells user warranty work (except extent warranties provided), licensees may convey work License, view copy License. interface presents list user commands options, menu, prominent item list meets criterion.","code":""},{"path":"/LICENSE.html","id":"id_1-source-code","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"1. Source Code","title":"GNU General Public License","text":"“source code” work means preferred form work making modifications . “Object code” means non-source form work. “Standard Interface” means interface either official standard defined recognized standards body, , case interfaces specified particular programming language, one widely used among developers working language. “System Libraries” executable work include anything, work whole, () included normal form packaging Major Component, part Major Component, (b) serves enable use work Major Component, implement Standard Interface implementation available public source code form. “Major Component”, context, means major essential component (kernel, window system, ) specific operating system () executable work runs, compiler used produce work, object code interpreter used run . “Corresponding Source” work object code form means source code needed generate, install, (executable work) run object code modify work, including scripts control activities. However, include work’s System Libraries, general-purpose tools generally available free programs used unmodified performing activities part work. example, Corresponding Source includes interface definition files associated source files work, source code shared libraries dynamically linked subprograms work specifically designed require, intimate data communication control flow subprograms parts work. Corresponding Source need include anything users can regenerate automatically parts Corresponding Source. Corresponding Source work source code form work.","code":""},{"path":"/LICENSE.html","id":"id_2-basic-permissions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"2. Basic Permissions","title":"GNU General Public License","text":"rights granted License granted term copyright Program, irrevocable provided stated conditions met. License explicitly affirms unlimited permission run unmodified Program. output running covered work covered License output, given content, constitutes covered work. License acknowledges rights fair use equivalent, provided copyright law. may make, run propagate covered works convey, without conditions long license otherwise remains force. may convey covered works others sole purpose make modifications exclusively , provide facilities running works, provided comply terms License conveying material control copyright. thus making running covered works must exclusively behalf, direction control, terms prohibit making copies copyrighted material outside relationship . Conveying circumstances permitted solely conditions stated . Sublicensing allowed; section 10 makes unnecessary.","code":""},{"path":"/LICENSE.html","id":"id_3-protecting-users-legal-rights-from-anti-circumvention-law","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"3. Protecting Users’ Legal Rights From Anti-Circumvention Law","title":"GNU General Public License","text":"covered work shall deemed part effective technological measure applicable law fulfilling obligations article 11 WIPO copyright treaty adopted 20 December 1996, similar laws prohibiting restricting circumvention measures. convey covered work, waive legal power forbid circumvention technological measures extent circumvention effected exercising rights License respect covered work, disclaim intention limit operation modification work means enforcing, work’s users, third parties’ legal rights forbid circumvention technological measures.","code":""},{"path":"/LICENSE.html","id":"id_4-conveying-verbatim-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"4. Conveying Verbatim Copies","title":"GNU General Public License","text":"may convey verbatim copies Program’s source code receive , medium, provided conspicuously appropriately publish copy appropriate copyright notice; keep intact notices stating License non-permissive terms added accord section 7 apply code; keep intact notices absence warranty; give recipients copy License along Program. may charge price price copy convey, may offer support warranty protection fee.","code":""},{"path":"/LICENSE.html","id":"id_5-conveying-modified-source-versions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"5. Conveying Modified Source Versions","title":"GNU General Public License","text":"may convey work based Program, modifications produce Program, form source code terms section 4, provided also meet conditions: ) work must carry prominent notices stating modified , giving relevant date. b) work must carry prominent notices stating released License conditions added section 7. requirement modifies requirement section 4 “keep intact notices”. c) must license entire work, whole, License anyone comes possession copy. License therefore apply, along applicable section 7 additional terms, whole work, parts, regardless packaged. License gives permission license work way, invalidate permission separately received . d) work interactive user interfaces, must display Appropriate Legal Notices; however, Program interactive interfaces display Appropriate Legal Notices, work need make . compilation covered work separate independent works, nature extensions covered work, combined form larger program, volume storage distribution medium, called “aggregate” compilation resulting copyright used limit access legal rights compilation’s users beyond individual works permit. Inclusion covered work aggregate cause License apply parts aggregate.","code":""},{"path":"/LICENSE.html","id":"id_6-conveying-non-source-forms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"6. Conveying Non-Source Forms","title":"GNU General Public License","text":"may convey covered work object code form terms sections 4 5, provided also convey machine-readable Corresponding Source terms License, one ways: ) Convey object code , embodied , physical product (including physical distribution medium), accompanied Corresponding Source fixed durable physical medium customarily used software interchange. b) Convey object code , embodied , physical product (including physical distribution medium), accompanied written offer, valid least three years valid long offer spare parts customer support product model, give anyone possesses object code either (1) copy Corresponding Source software product covered License, durable physical medium customarily used software interchange, price reasonable cost physically performing conveying source, (2) access copy Corresponding Source network server charge. c) Convey individual copies object code copy written offer provide Corresponding Source. alternative allowed occasionally noncommercially, received object code offer, accord subsection 6b. d) Convey object code offering access designated place (gratis charge), offer equivalent access Corresponding Source way place charge. need require recipients copy Corresponding Source along object code. place copy object code network server, Corresponding Source may different server (operated third party) supports equivalent copying facilities, provided maintain clear directions next object code saying find Corresponding Source. Regardless server hosts Corresponding Source, remain obligated ensure available long needed satisfy requirements. e) Convey object code using peer--peer transmission, provided inform peers object code Corresponding Source work offered general public charge subsection 6d. separable portion object code, whose source code excluded Corresponding Source System Library, need included conveying object code work. “User Product” either (1) “consumer product”, means tangible personal property normally used personal, family, household purposes, (2) anything designed sold incorporation dwelling. determining whether product consumer product, doubtful cases shall resolved favor coverage. particular product received particular user, “normally used” refers typical common use class product, regardless status particular user way particular user actually uses, expects expected use, product. product consumer product regardless whether product substantial commercial, industrial non-consumer uses, unless uses represent significant mode use product. “Installation Information” User Product means methods, procedures, authorization keys, information required install execute modified versions covered work User Product modified version Corresponding Source. information must suffice ensure continued functioning modified object code case prevented interfered solely modification made. convey object code work section , , specifically use , User Product, conveying occurs part transaction right possession use User Product transferred recipient perpetuity fixed term (regardless transaction characterized), Corresponding Source conveyed section must accompanied Installation Information. requirement apply neither third party retains ability install modified object code User Product (example, work installed ROM). requirement provide Installation Information include requirement continue provide support service, warranty, updates work modified installed recipient, User Product modified installed. Access network may denied modification materially adversely affects operation network violates rules protocols communication across network. Corresponding Source conveyed, Installation Information provided, accord section must format publicly documented (implementation available public source code form), must require special password key unpacking, reading copying.","code":""},{"path":"/LICENSE.html","id":"id_7-additional-terms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"7. Additional Terms","title":"GNU General Public License","text":"“Additional permissions” terms supplement terms License making exceptions one conditions. Additional permissions applicable entire Program shall treated though included License, extent valid applicable law. additional permissions apply part Program, part may used separately permissions, entire Program remains governed License without regard additional permissions. convey copy covered work, may option remove additional permissions copy, part . (Additional permissions may written require removal certain cases modify work.) may place additional permissions material, added covered work, can give appropriate copyright permission. Notwithstanding provision License, material add covered work, may (authorized copyright holders material) supplement terms License terms: ) Disclaiming warranty limiting liability differently terms sections 15 16 License; b) Requiring preservation specified reasonable legal notices author attributions material Appropriate Legal Notices displayed works containing ; c) Prohibiting misrepresentation origin material, requiring modified versions material marked reasonable ways different original version; d) Limiting use publicity purposes names licensors authors material; e) Declining grant rights trademark law use trade names, trademarks, service marks; f) Requiring indemnification licensors authors material anyone conveys material (modified versions ) contractual assumptions liability recipient, liability contractual assumptions directly impose licensors authors. non-permissive additional terms considered “restrictions” within meaning section 10. Program received , part , contains notice stating governed License along term restriction, may remove term. license document contains restriction permits relicensing conveying License, may add covered work material governed terms license document, provided restriction survive relicensing conveying. add terms covered work accord section, must place, relevant source files, statement additional terms apply files, notice indicating find applicable terms. Additional terms, permissive non-permissive, may stated form separately written license, stated exceptions; requirements apply either way.","code":""},{"path":"/LICENSE.html","id":"id_8-termination","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"8. Termination","title":"GNU General Public License","text":"may propagate modify covered work except expressly provided License. attempt otherwise propagate modify void, automatically terminate rights License (including patent licenses granted third paragraph section 11). However, cease violation License, license particular copyright holder reinstated () provisionally, unless copyright holder explicitly finally terminates license, (b) permanently, copyright holder fails notify violation reasonable means prior 60 days cessation. Moreover, license particular copyright holder reinstated permanently copyright holder notifies violation reasonable means, first time received notice violation License (work) copyright holder, cure violation prior 30 days receipt notice. Termination rights section terminate licenses parties received copies rights License. rights terminated permanently reinstated, qualify receive new licenses material section 10.","code":""},{"path":"/LICENSE.html","id":"id_9-acceptance-not-required-for-having-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"9. Acceptance Not Required for Having Copies","title":"GNU General Public License","text":"required accept License order receive run copy Program. Ancillary propagation covered work occurring solely consequence using peer--peer transmission receive copy likewise require acceptance. However, nothing License grants permission propagate modify covered work. actions infringe copyright accept License. Therefore, modifying propagating covered work, indicate acceptance License .","code":""},{"path":"/LICENSE.html","id":"id_10-automatic-licensing-of-downstream-recipients","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"10. Automatic Licensing of Downstream Recipients","title":"GNU General Public License","text":"time convey covered work, recipient automatically receives license original licensors, run, modify propagate work, subject License. responsible enforcing compliance third parties License. “entity transaction” transaction transferring control organization, substantially assets one, subdividing organization, merging organizations. propagation covered work results entity transaction, party transaction receives copy work also receives whatever licenses work party’s predecessor interest give previous paragraph, plus right possession Corresponding Source work predecessor interest, predecessor can get reasonable efforts. may impose restrictions exercise rights granted affirmed License. example, may impose license fee, royalty, charge exercise rights granted License, may initiate litigation (including cross-claim counterclaim lawsuit) alleging patent claim infringed making, using, selling, offering sale, importing Program portion .","code":""},{"path":"/LICENSE.html","id":"id_11-patents","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"11. Patents","title":"GNU General Public License","text":"“contributor” copyright holder authorizes use License Program work Program based. work thus licensed called contributor’s “contributor version”. contributor’s “essential patent claims” patent claims owned controlled contributor, whether already acquired hereafter acquired, infringed manner, permitted License, making, using, selling contributor version, include claims infringed consequence modification contributor version. purposes definition, “control” includes right grant patent sublicenses manner consistent requirements License. contributor grants non-exclusive, worldwide, royalty-free patent license contributor’s essential patent claims, make, use, sell, offer sale, import otherwise run, modify propagate contents contributor version. following three paragraphs, “patent license” express agreement commitment, however denominated, enforce patent (express permission practice patent covenant sue patent infringement). “grant” patent license party means make agreement commitment enforce patent party. convey covered work, knowingly relying patent license, Corresponding Source work available anyone copy, free charge terms License, publicly available network server readily accessible means, must either (1) cause Corresponding Source available, (2) arrange deprive benefit patent license particular work, (3) arrange, manner consistent requirements License, extend patent license downstream recipients. “Knowingly relying” means actual knowledge , patent license, conveying covered work country, recipient’s use covered work country, infringe one identifiable patents country reason believe valid. , pursuant connection single transaction arrangement, convey, propagate procuring conveyance , covered work, grant patent license parties receiving covered work authorizing use, propagate, modify convey specific copy covered work, patent license grant automatically extended recipients covered work works based . patent license “discriminatory” include within scope coverage, prohibits exercise , conditioned non-exercise one rights specifically granted License. may convey covered work party arrangement third party business distributing software, make payment third party based extent activity conveying work, third party grants, parties receive covered work , discriminatory patent license () connection copies covered work conveyed (copies made copies), (b) primarily connection specific products compilations contain covered work, unless entered arrangement, patent license granted, prior 28 March 2007. Nothing License shall construed excluding limiting implied license defenses infringement may otherwise available applicable patent law.","code":""},{"path":"/LICENSE.html","id":"id_12-no-surrender-of-others-freedom","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"12. No Surrender of Others’ Freedom","title":"GNU General Public License","text":"conditions imposed (whether court order, agreement otherwise) contradict conditions License, excuse conditions License. convey covered work satisfy simultaneously obligations License pertinent obligations, consequence may convey . example, agree terms obligate collect royalty conveying convey Program, way satisfy terms License refrain entirely conveying Program.","code":""},{"path":"/LICENSE.html","id":"id_13-use-with-the-gnu-affero-general-public-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"13. Use with the GNU Affero General Public License","title":"GNU General Public License","text":"Notwithstanding provision License, permission link combine covered work work licensed version 3 GNU Affero General Public License single combined work, convey resulting work. terms License continue apply part covered work, special requirements GNU Affero General Public License, section 13, concerning interaction network apply combination .","code":""},{"path":"/LICENSE.html","id":"id_14-revised-versions-of-this-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"14. Revised Versions of this License","title":"GNU General Public License","text":"Free Software Foundation may publish revised /new versions GNU General Public License time time. new versions similar spirit present version, may differ detail address new problems concerns. version given distinguishing version number. Program specifies certain numbered version GNU General Public License “later version” applies , option following terms conditions either numbered version later version published Free Software Foundation. Program specify version number GNU General Public License, may choose version ever published Free Software Foundation. Program specifies proxy can decide future versions GNU General Public License can used, proxy’s public statement acceptance version permanently authorizes choose version Program. Later license versions may give additional different permissions. However, additional obligations imposed author copyright holder result choosing follow later version.","code":""},{"path":"/LICENSE.html","id":"id_15-disclaimer-of-warranty","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"15. Disclaimer of Warranty","title":"GNU General Public License","text":"WARRANTY PROGRAM, EXTENT PERMITTED APPLICABLE LAW. EXCEPT OTHERWISE STATED WRITING COPYRIGHT HOLDERS /PARTIES PROVIDE PROGRAM “” WITHOUT WARRANTY KIND, EITHER EXPRESSED IMPLIED, INCLUDING, LIMITED , IMPLIED WARRANTIES MERCHANTABILITY FITNESS PARTICULAR PURPOSE. ENTIRE RISK QUALITY PERFORMANCE PROGRAM . PROGRAM PROVE DEFECTIVE, ASSUME COST NECESSARY SERVICING, REPAIR CORRECTION.","code":""},{"path":"/LICENSE.html","id":"id_16-limitation-of-liability","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"16. Limitation of Liability","title":"GNU General Public License","text":"EVENT UNLESS REQUIRED APPLICABLE LAW AGREED WRITING COPYRIGHT HOLDER, PARTY MODIFIES /CONVEYS PROGRAM PERMITTED , LIABLE DAMAGES, INCLUDING GENERAL, SPECIAL, INCIDENTAL CONSEQUENTIAL DAMAGES ARISING USE INABILITY USE PROGRAM (INCLUDING LIMITED LOSS DATA DATA RENDERED INACCURATE LOSSES SUSTAINED THIRD PARTIES FAILURE PROGRAM OPERATE PROGRAMS), EVEN HOLDER PARTY ADVISED POSSIBILITY DAMAGES.","code":""},{"path":"/LICENSE.html","id":"id_17-interpretation-of-sections-15-and-16","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"17. Interpretation of Sections 15 and 16","title":"GNU General Public License","text":"disclaimer warranty limitation liability provided given local legal effect according terms, reviewing courts shall apply local law closely approximates absolute waiver civil liability connection Program, unless warranty assumption liability accompanies copy Program return fee. END TERMS CONDITIONS","code":""},{"path":"/LICENSE.html","id":"how-to-apply-these-terms-to-your-new-programs","dir":"","previous_headings":"","what":"How to Apply These Terms to Your New Programs","title":"GNU General Public License","text":"develop new program, want greatest possible use public, best way achieve make free software everyone can redistribute change terms. , attach following notices program. safest attach start source file effectively state exclusion warranty; file least “copyright” line pointer full notice found. Also add information contact electronic paper mail. program terminal interaction, make output short notice like starts interactive mode: hypothetical commands show w show c show appropriate parts General Public License. course, program’s commands might different; GUI interface, use “box”. also get employer (work programmer) school, , sign “copyright disclaimer” program, necessary. information , apply follow GNU GPL, see <http://www.gnu.org/licenses/>. GNU General Public License permit incorporating program proprietary programs. program subroutine library, may consider useful permit linking proprietary applications library. want , use GNU Lesser General Public License instead License. first, please read <http://www.gnu.org/philosophy/--lgpl.html>.","code":"<one line to give the program's name and a brief idea of what it does.> Copyright (C) <year>  <name of author>  This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>. <program>  Copyright (C) <year>  <name of author> This program comes with ABSOLUTELY NO WARRANTY; for details type 'show w'. This is free software, and you are welcome to redistribute it under certain conditions; type 'show c' for details."},{"path":"/articles/RSTr-adjacency.html","id":"sec-overview","dir":"Articles","previous_headings":"","what":"Overview","title":"02: Understanding and Preparing Your Adjacency Structure","text":"adjacency structure set instructions show spatial relationship region informs RSTr counties pull information spatially smoothing. vignette, cover requirements adjacency object along walking setup adjacency information.","code":""},{"path":"/articles/RSTr-adjacency.html","id":"requirements","dir":"Articles","previous_headings":"","what":"Requirements","title":"02: Understanding and Preparing Your Adjacency Structure","text":"Adjacency information input list adj element adj[[]] vector indices denoting regions neighbors region . , walk construction adjacency information address common issues may arise.","code":""},{"path":"/articles/RSTr-adjacency.html","id":"example-massachusetts-map-data","dir":"Articles","previous_headings":"","what":"Example: Massachusetts Map Data","title":"02: Understanding and Preparing Your Adjacency Structure","text":"example, continue using Massachusetts data section 2. Included example dataset contains Massachusetts shapefile information, generated using tigris package: dataset contains several variables related Census information Massachusetts, purposes interested two variables: GEOID contains FIPS code county. can use associate county counties event/population data; geometry describes map region. can use generate adjacency information. begin, let’s first arrange mamap GEOID ensure counties order maexample data, generate adjacency information using spdep package: spdep::poly2nb() takes information ma_shp$geometry looks regions touching boundaries (.e., queen contiguity). ma_adj list contains indices region neighbor given region. Looking ma_adj gives us information: ma_adj tells 14 regions linked 38 unique ways. However, also notes two regions links. Regions links problematic RSTr information spatially smooth, causing model crash. data incomplete format, investigation fixing get ready use. Let us first look dataset see counties neighbors. ma_adj tells us regions 4 10 regions links, can also use spdep::card() give us indices -link counties: can now investigate ma_shp counties neighbors: According , two -link counties Dukes Nantucket (FIPS 25007 25019, respectively). Let’s check ggplot data investigate:  , ’ve generated map colored region labeled name county. can see Dukes Nantucket southeast corner, zoom , can see two counties aren’t touching counties. Upon closer inspection, Barnstable County seems like good contender neighbor Dukes Nantucket County; Dukes Nantucket County also close enough neighbors . rectify , can make changes adjacency information. Let’s first get feel counties associated indices: can see Barnstable index 1, Dukes index 4, Nantucket index 10. can use add_neighbors() function set counties mutual neighbors: Now look ma_adj, message -link regions gone. Note run model RSTr load adjacency information saved model object, indices changed. adjacency information used within Rcpp, uses 0-indexing system opposed 1-indexing system used R. inputting data *car(), use 1-indexed adjacency structure. Finally, even though connected two island counties mainland counties MA, long region least one neighbor, usable within RSTr. means , theoretically, made just Dukes Nantucket neighbors , creating two separate islands related neighbors. case, every region islands still least one neighbor.","code":"head(mamap) ma_shp <- sf::st_as_sf(mamap[order(mamap$GEOID), ]) ma_adj <- spdep::poly2nb(ma_shp) #> Warning in spdep::poly2nb(ma_shp): some observations have no neighbours; #> if this seems unexpected, try increasing the snap argument. #> Warning in spdep::poly2nb(ma_shp): neighbour object has 3 sub-graphs; #> if this sub-graph count seems unexpected, try increasing the snap argument. ma_adj #> Neighbour list object: #> Number of regions: 14  #> Number of nonzero links: 38  #> Percentage nonzero weights: 19.38776  #> Average number of links: 2.714286  #> 2 regions with no links: #> 1252, 1577 #> 3 disjoint connected subgraphs no_neigh <- spdep::card(ma_adj) == 0 ma_shp[no_neigh, ] #> Simple feature collection with 2 features and 12 fields #> Geometry type: MULTIPOLYGON #> Dimension:     XY #> Bounding box:  xmin: -70.95137 ymin: 41.23796 xmax: -69.96018 ymax: 41.52178 #> Geodetic CRS:  NAD83 #>      STATEFP COUNTYFP COUNTYNS       AFFGEOID GEOID      NAME         NAMELSAD #> 1252      25      007 00606930 0500000US25007 25007     Dukes     Dukes County #> 1577      25      019 00606936 0500000US25019 25019 Nantucket Nantucket County #>      STUSPS    STATE_NAME LSAD     ALAND     AWATER #> 1252     MA Massachusetts   06 267292993 1004291414 #> 1577     MA Massachusetts   06 119637319  666826424 #>                            geometry #> 1252 MULTIPOLYGON (((-70.8071 41... #> 1577 MULTIPOLYGON (((-70.23405 4... library(ggplot2)  ggplot(mamap) +   geom_sf(aes(fill = NAME)) +   geom_sf_label(aes(label = NAME)) county_key <- seq_along(ma_shp$NAME) names(county_key) <- ma_shp$NAME county_key #> Barnstable  Berkshire    Bristol      Dukes      Essex   Franklin    Hampden  #>          1          2          3          4          5          6          7  #>  Hampshire  Middlesex  Nantucket    Norfolk   Plymouth    Suffolk  Worcester  #>          8          9         10         11         12         13         14 ma_adj <- add_neighbors(ma_adj, c(1, 4, 10))"},{"path":"/articles/RSTr-adjacency.html","id":"closing-thoughts","dir":"Articles","previous_headings":"","what":"Closing Thoughts","title":"02: Understanding and Preparing Your Adjacency Structure","text":"vignette, used spdep::poly2nb() generate adjacency structure. fixed issues counties without neighbors applied naming scheme adjacency information consistent data object created section 2. , RSTr model ready run data adjacency information!","code":""},{"path":"/articles/RSTr-agestandardize.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"04: Generating Estimates: Age-standardization","text":"previous vignette, discussed model setup process -depth. get estimates ’ve run model? vignette, discuss extracting estimates model object get_estimates() function, age-standardize estimates age_standardize().","code":""},{"path":"/articles/RSTr-agestandardize.html","id":"the-get_estimates-function","dir":"Articles","previous_headings":"","what":"The get_estimates() function","title":"04: Generating Estimates: Age-standardization","text":"RSTr introductory vignette, generated age-standardized estimates lambda based example Michigan dataset. extract rates RSTr object, can simply run get_estimates():","code":"mod_mst <- mstcar(name = \"my_test_model\", data = miheart, adjacency = miadj) #> Starting sampler on Batch 1 at Thu Dec 11 00:05:36 #> Generating estimates... #> Model finished at Thu Dec 11 00:06:05 estimates <- get_estimates(mod_mst, rates_per = 1e5) head(estimates) #>   county group year  medians credible_interval_lower credible_interval_upper #> 1  26001 35-44 1979 45.07149                31.48676                59.17320 #> 2  26003 35-44 1979 56.47176                35.01048                85.83469 #> 3  26005 35-44 1979 24.35092                17.47599                30.61988 #> 4  26007 35-44 1979 35.13386                18.28414                48.08389 #> 5  26009 35-44 1979 34.24613                19.40691                45.97550 #> 6  26011 35-44 1979 46.13104                28.16870                65.56977 #>   relative_precision events population #> 1           1.627926      1        964 #> 2           1.111119      1       1011 #> 3           1.852641      0       9110 #> 4           1.178999      0       3650 #> 5           1.288970      0       1763 #> 6           1.233415      0       1470"},{"path":"/articles/RSTr-agestandardize.html","id":"the-age_standardization-function","dir":"Articles","previous_headings":"","what":"The age_standardization() function","title":"04: Generating Estimates: Age-standardization","text":"many cases, want age-standardize estimates based () age groups dataset. Michigan dataset, six ten-year age groups can standardize; let’s age-standardize ages 35-64. RSTr objects, age_standardize() takes four arguments: RSTr_obj: RSTr model object created *car(); std_pop: vector standard populations associated age groups interest. Since Michigan data 1979-1988, can use 1980 standard populations NIH. recommended use standard population closely associated dataset; new_name: name new standard population group; groups: vector names matching group interest. age-standardize groups dataset, leave argument blank. std_pop vector, can age-standardize estimates: Notice now mod_mst object indicates age-standardized estimates names age-standardized group. can also add list age-standardized estimates simply specifying different group: want generate estimates groups, .e. 35 , can omit groups argument expand std_pop include populations: Now, get_estimates(mod_mst) shows age-standardized estimates opposed non-standardized estimates. want see non-standardized estimates instead, can set argument standardized = FALSE.","code":"std_pop <- c(113154, 100640, 95799) mod_mst <- age_standardize(mod_mst, std_pop, new_name = \"35-64\", groups = c(\"35-44\", \"45-54\", \"55-64\")) mod_mst #> RSTr object: #>  #> Model name: my_test_model  #> Model type: MSTCAR  #> Data likelihood: binomial  #> Estimate Credible Interval: 95%  #> Number of geographic units: 83  #> Number of samples: 6000  #> Estimates age-standardized: Yes  #> Age-standardized groups: 35-64  #> Estimates suppressed: No std_pop <- c(68775, 34116, 9888) mod_mst <- age_standardize(mod_mst, std_pop, new_name = \"65up\", groups = c(\"65-74\", \"75-84\", \"85+\")) mod_mst #> RSTr object: #>  #> Model name: my_test_model  #> Model type: MSTCAR  #> Data likelihood: binomial  #> Estimate Credible Interval: 95%  #> Number of geographic units: 83  #> Number of samples: 6000  #> Estimates age-standardized: Yes  #> Age-standardized groups: 35-64 65up  #> Estimates suppressed: No std_pop <- c(113154, 100640, 95799, 68775, 34116, 9888) mod_mst <- age_standardize(mod_mst, std_pop, new_name = \"35up\") mod_mst #> RSTr object: #>  #> Model name: my_test_model  #> Model type: MSTCAR  #> Data likelihood: binomial  #> Estimate Credible Interval: 95%  #> Number of geographic units: 83  #> Number of samples: 6000  #> Estimates age-standardized: Yes  #> Age-standardized groups: 35-64 65up 35up  #> Estimates suppressed: No mst_estimates_as <- get_estimates(mod_mst) head(mst_estimates_as) #>   county group year  medians credible_interval_lower credible_interval_upper #> 1  26001 35-64 1979 203.3206                157.7320                241.9712 #> 2  26003 35-64 1979 290.8983                223.9136                384.6817 #> 3  26005 35-64 1979 124.6186                103.7021                142.7059 #> 4  26007 35-64 1979 174.7536                138.9969                204.4177 #> 5  26009 35-64 1979 171.6994                134.1164                209.4447 #> 6  26011 35-64 1979 223.7704                183.4417                276.1411 #>   relative_precision events population #> 1           2.413612      7       3353 #> 2           1.809428     12       3105 #> 3           3.195035     27      23926 #> 4           2.671222     15      10000 #> 5           2.279347     11       5152 #> 6           2.413933      8       4517"},{"path":"/articles/RSTr-agestandardize.html","id":"final-thoughts","dir":"Articles","previous_headings":"","what":"Final thoughts","title":"04: Generating Estimates: Age-standardization","text":"vignette, explored get_estimates() function investigated age-standardization age_standardize() function. Age-standardization one important features RSTr package; using just arguments, can easily generate estimates across population groups.","code":""},{"path":"/articles/RSTr-car.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"03: The CAR Models","text":"*car() functions (eucar(), ucar(), mcar(), mstcar()) build necessary features needed run RSTr places specified directory. vignette, talk detail model, arguments used *car() functions, use .","code":""},{"path":"/articles/RSTr-car.html","id":"the-car-functions","dir":"Articles","previous_headings":"","what":"The *car() functions","title":"03: The CAR Models","text":"current version RSTr features four models choose : Univariate CAR (UCAR), also known Besag-York-Mollié (BYM) model, Enhanced UCAR (EUCAR) model, Multivariate CAR (MCAR) model, Multivariate Spatiotemporal CAR (MSTCAR) model. now compare models use cases.","code":""},{"path":"/articles/RSTr-car.html","id":"the-ucar-model","dir":"Articles","previous_headings":"The *car() functions","what":"The UCAR model","title":"03: The CAR Models","text":"UCAR model (function call ucar()) basis models used RSTr. premise UCAR spatially smooth estimates across spatial regions using random effects estimator Z. intensity smoothing region based event population counts region counts neighboring regions. UCAR model smooths across spatial regions across sociodemographic groups time periods. datasets include stratifications can run ucar(), user effectively running several concurrent UCAR models. UCAR model recommended user data one sociodemographic group interest one time-period.","code":""},{"path":"/articles/RSTr-car.html","id":"the-eucar-model","dir":"Articles","previous_headings":"The *car() functions","what":"The EUCAR model","title":"03: The CAR Models","text":"EUCAR model (function call eucar()) recent BYM implementation RSTr. EUCAR model follows general paradigm UCAR model, prevents oversmoothing capping spatial non-spatial variance. Even though EUCAR smooths across spatial regions, estimates generated eucar() nuanced strike happy medium use crude rate estimates oversmoothing standard UCAR model.","code":""},{"path":"/articles/RSTr-car.html","id":"the-mcar-model","dir":"Articles","previous_headings":"The *car() functions","what":"The MCAR model","title":"03: The CAR Models","text":"MCAR model (function call mcar()) extension UCAR model: whereas UCAR model can smooth spatial regions, MCAR model can smooth spatial regions sociodemographic groups. MCAR model ideal datasets include multiple sociodemographic groups. Enhanced MCAR (EMCAR) model currently development implemented RSTr methodology finalized.","code":""},{"path":"/articles/RSTr-car.html","id":"the-mstcar-model","dir":"Articles","previous_headings":"The *car() functions","what":"The MSTCAR model","title":"03: The CAR Models","text":"MSTCAR model (function call mstcar()) extension MCAR model, allowing smoothing spatial regions, sociodemographic groups, time periods. MSTCAR model ideal investigating trends rate estimates specified time period.","code":""},{"path":"/articles/RSTr-car.html","id":"arguments-of-the-car-function","dir":"Articles","previous_headings":"","what":"Arguments of the *car() function","title":"03: The CAR Models","text":"*car() functions provide several arguments: name: name folder model information lives ; data: list object containing event Y population n data. information data setup, read vignette(\"RSTr-event\"); adjacency: adjacency structure event population data. information adjacency structure setup, read vignette(\"RSTr-adjacency\"); dir: directory model folder lives. default, saves temporary directory, model information lost R session ends. want save model analyzed later date ensure samples intact R crashes runtime, specify different directory; seed: Allows user specify random seed used replication purposes; perc_ci: number 0 1 specifies desired credible interval use calculating relative precision estimates. default, set 0.95; iterations: number iterations run model ; show_plots: set FALSE, hides traceplots model execution; verbose: set FALSE, hides progress bar messages console; ignore_checks: set TRUE, skips model validation; method: Chooses whether event data either Binomial (\"binomial\") Poisson (\"poisson\") distributed. default, RSTr uses Binomial updates event data; impute_lb: Specifies lower bound imputed data event information missing suppressed; impute_ub: Specifies upper bound imputed data event information missing suppressed; initial_values: list initial values parameter. can specified user generated default. information specification initial_values, see vignette(\"RSTr-initialvalues\"); priors: list prior information parameter. can specified user generated default. information specification priors, see vignette(\"RSTr-priors\"). arguments needed, model defaults many . eucar() mstcar() additional arguments used : : EUCAR model, describes limit smoothing intensity regions; m0: EUCAR model, specifies baseline neighbor count; update_rho: MSTCAR model, allows updates temporal correlation parameter rho. default, RSTr update rho. run errors trying initialize model, read vignette(\"RSTr-troubleshoot\"). , go detail regarding argument specifically keep mind setting values.","code":""},{"path":"/articles/RSTr-car.html","id":"the-initial_values-argument","dir":"Articles","previous_headings":"Arguments of the *car() function","what":"The initial_values argument","title":"03: The CAR Models","text":"initial_values list specifying starting values parameters model. Details around initial value parameters can found vignette(\"RSTr-initialvalues\").","code":""},{"path":"/articles/RSTr-car.html","id":"the-priors-argument","dir":"Articles","previous_headings":"Arguments of the *car() function","what":"The priors argument","title":"03: The CAR Models","text":"priors behaves similar initial_values, except contains information related parameter priors. Details around initial value parameters can found vignette(\"RSTr-priors\").","code":""},{"path":"/articles/RSTr-car.html","id":"the-method-argument","dir":"Articles","previous_headings":"Arguments of the *car() function","what":"The method argument","title":"03: The CAR Models","text":"method offers two values: \"binomial\" \"poisson\". values determine data transformed lambda Metropolis update performed: \"binomial\" treats event data Binomial-distributed \"poisson\" treats event data Poisson-distributed. Depending use case, ’ll want choose two: example, working small mortality rates, \"poisson\" work well, working birth rates, example, \"binomial\" work better. Note \"binomial\" works general use cases \"poisson\" works well datasets small rates approximately 1%.","code":""},{"path":"/articles/RSTr-car.html","id":"m0-and-a","dir":"Articles","previous_headings":"Arguments of the *car() function","what":"m0 and A","title":"03: The CAR Models","text":"m0 two components determine intensity smoothing Enhanced CAR models. m0 positive scalar, size dependent group/time structure data: positive scalar region-models, vector size num_group region-group models, matrix size num_group x num_time region-group-time models. Note, however, informativeness restriction measures currently developed UCAR model, restrictions complex models added RSTr package respective methods developed.","code":""},{"path":"/articles/RSTr-car.html","id":"the-update_rho-argument","dir":"Articles","previous_headings":"Arguments of the *car() function","what":"The update_rho argument","title":"03: The CAR Models","text":"MSTCAR model, update_rho logical specifies whether calculate estimates temporal correlation rho. default, set FALSE. empirical testing, estimate found sensitive changes specified prudently also increases runtime order magnitude due complexity.","code":""},{"path":"/articles/RSTr-car.html","id":"the-seed-argument","dir":"Articles","previous_headings":"Arguments of the *car() function","what":"The seed argument","title":"03: The CAR Models","text":"stochastic nature Bayesian inference inherent instability MSTCAR model, replicability extremely important. seed allows user specify seed generating similar estimates.","code":""},{"path":"/articles/RSTr-car.html","id":"the-ignore_checks-argument","dir":"Articles","previous_headings":"Arguments of the *car() function","what":"The ignore_checks argument","title":"03: The CAR Models","text":"development continues RSTr, occasions checks performed inputs *car() throw error, even though may certain inputs behaving expected. override checks, can use ignore_checks argument. Set TRUE skip step.","code":""},{"path":"/articles/RSTr-car.html","id":"closing-thoughts","dir":"Articles","previous_headings":"","what":"Closing Thoughts","title":"03: The CAR Models","text":"Initialization one important steps running model, ’s virtually choices regarding model made. vignette, explored available type CAR model RSTr, arguments *car() functions, appropriately choose values argument.","code":""},{"path":"/articles/RSTr-event.html","id":"sec-overview","dir":"Articles","previous_headings":"","what":"Overview","title":"01: Understanding and Preparing Your Event Data","text":"event population data core BYM-based models used RSTr package. work alongside adjacency information generate smoothed estimates. vignette, ’ll discuss requirements event population data walk example data.frame.","code":""},{"path":"/articles/RSTr-event.html","id":"sec-requirements","dir":"Articles","previous_headings":"","what":"Requirements","title":"01: Understanding and Preparing Your Event Data","text":"Data must list object names Y n event counts population counts, respectively; Y n intended entire-population data. possible use RSTr analyze survey data datasets don’t include members population interest, RSTr currently allow inclusion survey weights thus assumes Y / n unbiased estimate underlying event rate; Y n must contain real numbers. Negative infinite counts allowed, suppressed data containing NA’s acceptable Y values. Note, however, n must population counts; given CAR model, Y must least one total event. CAR model able smooth information event data present. UCAR model, includes set regions; MCAR model, set regions groups; MSTCAR model, entire dataset; Y n can three-dimensional array: first margin (rows) specifies region, second margin (columns) specifies groups interest, third margin (matrix slices) specifies time period; Time periods, regions, groups must consistent. data contains counts regions specified set groups 1979 1981, example, must also include counts regions groups 1980 well, even counts zero events; Groups many types allowed long sociodemographic groups combined appropriate margin. example, groups may include just age groups, mixture age-sex groups, even mix age-race-sex groups; Finally, Y n must dimension names associated . makes easy identification counties, groups, time periods, necessary want age-standardize data using RSTr’s additional functionality.","code":""},{"path":"/articles/RSTr-event.html","id":"sec-example","dir":"Articles","previous_headings":"","what":"Example: CDC WONDER dataset","title":"01: Understanding and Preparing Your Event Data","text":"walk data setup data.frame final array list, use data generated CDC WONDER’s Underlying Cause Death Compressed Mortality, ICD-9 database, found https://wonder.cdc.gov/cmf-icd9.html: example dataset contains acute myocardial infarction (ICD-9: 410) mortality population data counties Massachusetts men women aged 35-64 1979 1981. dataset also includes notes bottom rows describing dataset. maexample contains several variables: Notes: Provides general information dataset, starting row 85; Year Year.Code specify year; County County.Code specify county name associated FIPS code; Sex Sex.Code specify sex group; Deaths contains mortality counts interest; Population contains population counts interest; Crude.Rate shows rates per 100,000 year-county-sex group. purposes, column can ignored. first thing want dataset remove notes bottom rows - useful getting acquainted dataset, ultimately mess population arrays. Since Year information rows notes, can use filter data: code searches values maexample$Year aren’t NA creates new dataset containing rows. start generating arrays, let’s take stock data listed : RSTr offers generate_data() function can transform dataset mortality population arrays properly oriented margins: want manually set data, can create Y n arrays using xtabs() function consolidate list used model: Note must specify names array element , creating list just objects name element, names Y n necessary RSTr know use data. multiple types groups, race sex, can take little finessing set group data, creating combined race-sex group variable, data setup follow principles .","code":"head(maexample) #>   Notes Year Year.Code                County County.Code    Sex Sex.Code Deaths #> 1       1979      1979 Barnstable County, MA       25001 Female        F     15 #> 2       1979      1979 Barnstable County, MA       25001   Male        M     57 #> 3       1979      1979  Berkshire County, MA       25003 Female        F     11 #> 4       1979      1979  Berkshire County, MA       25003   Male        M     63 #> 5       1979      1979    Bristol County, MA       25005 Female        F     52 #> 6       1979      1979    Bristol County, MA       25005   Male        M    191 #>   Population        Crude.Rate #> 1      25239 59.4 (Unreliable) #> 2      21261             268.1 #> 3      24884 44.2 (Unreliable) #> 4      22465             280.4 #> 5      80171              64.9 #> 6      71943             265.5 ma_mort <- maexample[which(!is.na(maexample$Year)), ] head(ma_mort) #>   Notes Year Year.Code                County County.Code    Sex Sex.Code Deaths #> 1       1979      1979 Barnstable County, MA       25001 Female        F     15 #> 2       1979      1979 Barnstable County, MA       25001   Male        M     57 #> 3       1979      1979  Berkshire County, MA       25003 Female        F     11 #> 4       1979      1979  Berkshire County, MA       25003   Male        M     63 #> 5       1979      1979    Bristol County, MA       25005 Female        F     52 #> 6       1979      1979    Bristol County, MA       25005   Male        M    191 #>   Population        Crude.Rate #> 1      25239 59.4 (Unreliable) #> 2      21261             268.1 #> 3      24884 44.2 (Unreliable) #> 4      22465             280.4 #> 5      80171              64.9 #> 6      71943             265.5 ma_data <- generate_data(ma_mort, Deaths, Population, County.Code, Sex.Code, Year.Code) Y <- xtabs(Deaths ~ County.Code + Sex.Code + Year.Code, data = ma_mort) n <- xtabs(Population ~ County.Code + Sex.Code + Year.Code, data = ma_mort) ma_data <- list(Y = Y, n = n)"},{"path":"/articles/RSTr-event.html","id":"data-setup-for-other-models","dir":"Articles","previous_headings":"","what":"Data setup for other models","title":"01: Understanding and Preparing Your Event Data","text":"dataset prepared specifically MSTCAR model. want prepare data MCAR even UCAR model? can filter original dataset follow similar procedure prepare data MCAR model: Note xtabs() works aggregating data along specified variables expression argument. case MCAR model, filter year want otherwise, give us mortality population counts years dataset instead just 1979. UCAR model, setup similar:","code":"ma_mort_mcar <- maexample[which(!is.na(maexample$Year)), ] ma_mort_mcar <- ma_mort_mcar[ma_mort_mcar$Year == 1979, ] # filter dataset to only show 1979 data ma_data_mcar <- generate_data(ma_mort_mcar, Deaths, Population, County.Code, Sex.Code) ma_mort_ucar <- maexample[which(!is.na(maexample$Year)), ] ma_mort_ucar <- ma_mort_ucar[ma_mort_ucar$Year == 1979 & ma_mort_ucar$Sex == \"Male\", ] # filter dataset to only show 1979 data for men ma_data_ucar <- generate_data(ma_mort_ucar, Deaths, Population, County.Code)"},{"path":"/articles/RSTr-event.html","id":"closing-thoughts","dir":"Articles","previous_headings":"","what":"Closing Thoughts","title":"01: Understanding and Preparing Your Event Data","text":"vignette, used data generated CDC WONDER construct event population counts, remove unnecessary rows using filter(), construct list using generate_data(). Setting data RSTr can seem daunting first, quick tricks R, can easy data organized analysis.","code":""},{"path":"/articles/RSTr-informativeness.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"06: Model Informativeness","text":"point, ’ve discussed preparing count/adjacency data, model setup, age-standardization. vignette(\"RSTr-reliability\"), discussed suppress estimates based reliability criteria, including population thresholds relative precision. However, cases event population counts low RSTr meaningfully gather information neighboring regions; cases, standard BYM models apply excessive spatial smoothing, artificially inflating estimate’s relative precision. vignette, look hood CAR models perform spatial smoothing, discuss model informativeness, work restricted models data.","code":""},{"path":"/articles/RSTr-informativeness.html","id":"how-does-spatial-smoothing-work","dir":"Articles","previous_headings":"","what":"How does spatial smoothing work?","title":"06: Model Informativeness","text":"Spatial smoothing acts way spatial random effects estimator Z; essentially parameter tells model much either increase decrease corresponding estimated rate lambda. CAR models, strength Z determined host factors, importantly spatial variance (sig2 UCAR; G MCAR MSTCAR). can investigate spatial smoothing running UCAR model see evolution Z time:  magnitude sig2 implications rate estimates lambda. Smaller sig2 values mean variance neighbors also smaller. short, smaller sig2, closer value estimate neighbors . combined comparatively intense smoothing applied smaller event/population regions, unrestricted CAR models work hard fill gaps information, pushing estimate value close mean beta also artificially inflating relative precision. unrestricted CAR models, oversmoothing partially addressed imposing additional reliability criterion either population event threshold. estimate relative precision greater 1, can still mark unreliable threshold small. can investigate datapoints comparing event counts corresponding relative precisions:  horizontal blue line shows relative precision cutoff, vertical blue line shows event cutoff based suppression criteria currently used CDC WONDER (event counts less 10 suppressed privacy reasons). Red datapoints population threshold relative precision threshold. plot showcases intense oversmoothing done UCAR model small-event areas. Several regions less 10 events (25, 30% regions) relative precisions well necessary threshold reliability, despite low event counts. Hence, impose threshold prevent estimates marked reliable. However, fixes part problem: relative precisions still artificially inflated throughout non-suppressed estimates, even lesser degree. address issue, need stop oversmoothing first place placing limit model informativeness.","code":"data_u <- lapply(miheart, \\(x) x[, \"55-64\", \"1979\", drop = FALSE]) mod_ucar <- ucar(\"my_test_model\", data_u, miadj, tempdir(), seed = 1234) #> Starting sampler on Batch 1 at Thu Dec 11 00:06:14 #> Generating estimates... #> Model finished at Thu Dec 11 00:06:21 estimates <- get_estimates(mod_ucar) estimates_supp <- estimates[estimates$relative_precision > 1 & estimates$events < 10, ] plot(estimates$events, estimates$relative_precision, xlab = \"Events\", ylab = \"Relative Precision\") points(estimates_supp$events, estimates_supp$relative_precision, col = \"red\") abline(h = 1, col = \"blue\") abline(v = 10, col = \"blue\")"},{"path":"/articles/RSTr-informativeness.html","id":"model-informativeness","dir":"Articles","previous_headings":"","what":"Model informativeness","title":"06: Model Informativeness","text":"Effectively, model informativeness quantifies amount ‘artificial events’ added model spatial smoothing. example , resulted 25 regions sufficiently high number events added oversmoothing -inflate relative precision. UCAR model’s informativeness, a0, determined mix spatial variance sig2, non-spatial variance tau2, mean region rate beta Binomially-distributed likelihoods. Poisson-distributed likelihoods, sig2 tau2 determine informativeness.","code":""},{"path":"/articles/RSTr-informativeness.html","id":"the-enhanced-ucar-eucar-model","dir":"Articles","previous_headings":"","what":"The Enhanced UCAR (EUCAR) model","title":"06: Model Informativeness","text":"RSTr features unrestricted UCAR/MCAR/MSTCAR models, also features enhanced UCAR (EUCAR) model incorporates measures prevent oversmoothing. EUCAR model, can limit informativeness a0 ceiling, , tweaking estimation process sig2, tau2, beta. ensure spatial smoothing contribute events estimate model. additional m0 parameter defines baseline number neighbors per region. Consequently, spatial/non-spatial variances increase -smoothing appropriately attenuated; permit model allow pronounced differences neighboring regions. importantly, gives us happy medium smoothing crude estimates oversmoothing caused unrestricted CAR models. Quick et al. 2021 suggests informativeness ceiling 6 m0 3 ensure regions event counts less 10 erroneously generate precise estimates. RSTr sets 6 m0 3 default. Let’s run EUCAR model using eucar() function, setting informativeness ceiling = 6:  Notice traceplots tau2 sig2 enhanced (.e., restricted) UCAR model significantly higher values unrestricted UCAR model. due EUCAR model ‘blocking’ lower values ensuring regions don’t oversmooth. can directly compare two sets results another relative precision plot:  , estimates EUCAR purple estimates unrestricted UCAR black. Notice points purple curve stay black curve low event counts purple points enter high-precision, low-event quadrant. = 6, points lie 1 relative precision events greater 10, meaning informativeness ceiling smoothing ideal amount. can also map two estimates visually compare models:   expected, gradient estimates much sharp EUCAR model map comparison unrestricted UCAR map. due decreased intensity spatial smoothing. Additionally, spread estimates EUCAR model wider unrestricted UCAR model increased spatial variance.","code":"mod_eucar <- eucar(\"my_test_model\", data_u, miadj, tempdir(), seed = 1234, A = 6) #> Starting sampler on Batch 1 at Thu Dec 11 00:06:21 #> Generating estimates... #> Model finished at Thu Dec 11 00:06:28 estimates_eucar <- get_estimates(mod_eucar) plot(estimates_eucar$events, estimates_eucar$relative_precision, xlab = \"Events\", ylab = \"Relative Precision\", col = \"purple\") points(estimates$events, estimates$relative_precision) abline(h = 1, col = \"blue\") abline(v = 10, col = \"blue\") library(ggplot2) ggplot(mishp) +   geom_sf(aes(fill = estimates$medians)) +   labs(     title = \"Spatially Smoothed Estimates, Unrestricted UCAR Model\",     fill = \"Deaths per 100,000\"   ) +   scale_fill_viridis_c() +   theme_void() ggplot(mishp) +   geom_sf(aes(fill = estimates_eucar$medians)) +   labs(     title = \"Spatially Smoothed Estimates, EUCAR Model\",     fill = \"Deaths per 100,000\"   ) +   scale_fill_viridis_c() +   theme_void()"},{"path":"/articles/RSTr-informativeness.html","id":"enhanced-models-and-age-standardization","dir":"Articles","previous_headings":"","what":"Enhanced models and age-standardization","title":"06: Model Informativeness","text":"age-standardizing across CAR model, informativeness cumulative: informativeness individual rates spatially smoothing compound informativeness estimates age-standardized spatially smoothed rates. Therefore, EUCAR excellent choice modeling age-standardization. individual estimates -smoothed, age-standardized estimates benefit enhanced reliability due increased event counts crude data. can re-run model three age groups: 65-74, 75-84, 85+. Since now running models across multiple groups, need extend match number groups. Additionally, since informativeness measures cumulative age-standardizing, split = 6 informativeness ceiling among groups interest. want, can weight group’s total events:  individual groups lower relative precisions due lower respective , age-standardize, effective smoothing power singular = 6 restricted model:","code":"data_u <- lapply(miheart, \\(x) x[, c(\"65-74\", \"75-84\", \"85+\"), \"1988\", drop = FALSE]) A <- 6 * colSums(data_u$Y) / sum(data_u$Y) mod_eucar <- eucar(\"test_eucar\", data_u, miadj, tempdir(), seed = 1234, A = A) #> Starting sampler on Batch 1 at Thu Dec 11 00:06:29 #> Generating estimates... #> Model finished at Thu Dec 11 00:06:37 std_pop <- c(68775, 34116, 9888) mod_eucar <- age_standardize(mod_eucar, std_pop, \"65up\") est_eucar <- get_estimates(mod_eucar) ggplot(mishp) +   geom_sf(aes(fill = est_eucar$medians)) +   labs(     title = \"Age-Standardized Spatially Smoothed Estimates, EUCAR Model\",     fill = \"Deaths per 100,000\"   ) +   scale_fill_viridis_c() +   theme_void()"},{"path":"/articles/RSTr-informativeness.html","id":"the-eucar-model-reliability-and-suppression","dir":"Articles","previous_headings":"","what":"The EUCAR Model, Reliability, and Suppression","title":"06: Model Informativeness","text":"Remember unrestricted CAR models, impose additional event/population threshold reliability capture high-precision estimates low-event areas. saw event/relative precision plot, thresholds longer necessary suppress estimates EUCAR model:  EUCAR model, get benefit age-standardizing spatially smoothed estimates without compounded oversmoothing unrestricted models.","code":"mod_eucar <- suppress_estimates(mod_eucar) est_eucar <- get_estimates(mod_eucar) ggplot(mishp) +   geom_sf(aes(fill = est_eucar$medians_suppressed)) +   labs(     title = \"Spatially Smoothed Estimates, EUCAR Model\",     fill = \"Deaths per 100,000\"   ) +   scale_fill_viridis_c() +   theme_void()"},{"path":"/articles/RSTr-informativeness.html","id":"choosing-between-enhanced-vs-unrestricted-models","dir":"Articles","previous_headings":"","what":"Choosing between enhanced vs unrestricted models","title":"06: Model Informativeness","text":"Now ’ve elucidated benefits using enhanced models, can work appropriate use case model: EUCAR model virtually always preferred unrestricted UCAR model. interested temporal trends group/time interactions, EUCAR likely best option, particularly age-standardizing. MCAR model useful specifically interested interactions sociodemographic groups don’t temporal data. MSTCAR model best option investigating linear trends temporal data specifically interested interactions sociodemographic groups across time. trends depict multiple behaviors, recommended either run two MSTCAR models separate time periods trend run concurrent EUCAR models. Note *car() functions accept three-dimensional arrays concurrently run models different groups/time periods necessary.","code":""},{"path":"/articles/RSTr-informativeness.html","id":"future-developments","dir":"Articles","previous_headings":"","what":"Future developments","title":"06: Model Informativeness","text":"Enhanced models MCAR MSTCAR continue development. Development enhanced Univariate Spatiotemporal CAR (USTCAR) model also underway. RSTr incorporate enhanced models become available.","code":""},{"path":"/articles/RSTr-informativeness.html","id":"final-thoughts","dir":"Articles","previous_headings":"","what":"Final thoughts","title":"06: Model Informativeness","text":"vignette, investigated model informativeness tendency unrestricted BYM models oversmooth estimates, along benefits enhanced CAR models. vignette concludes main sections using functions RSTr package. reading , able prepare event adjacency data, choose configure model necessary, age-standardize estimates, determine estimates reliable. interested advanced features RSTr involving sample processing, read vignette(\"RSTr-samples\"); ’d like information defining custom initial_values priors, check vignette(\"RSTr-initialvalues\") vignette(\"RSTr-priors\"), respectively; interested learning RSTr’s models work, read vignette(\"RSTr-models\").","code":""},{"path":"/articles/RSTr-initialvalues.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"08: Initial Values","text":"initial_values list specifying starting values parameters model. default, values specified according literature, RSTr allows capability specifying initial values. wish provide initial values, note don’t specify initial_values parameters want specify - undefined initial_values defined default values. example, can specify initial values lambda values generated . However, one value specified certain parameter initial_values, values must specified parameter initial_values: , example, define initial values just one year lambda. Finally, values included initial_values list aren’t aligned names ignored.","code":""},{"path":"/articles/RSTr-initialvalues.html","id":"initial-value-specifications","dir":"Articles","previous_headings":"","what":"Initial value specifications","title":"08: Initial Values","text":"models RSTr share many initial_values, couple models initial_values unique . potential initial values presented .","code":""},{"path":"/articles/RSTr-initialvalues.html","id":"initial-values-for-the-mstcar-model","dir":"Articles","previous_headings":"Initial value specifications","what":"Initial values for the MSTCAR model","title":"08: Initial Values","text":"possible initial value parameters MSTCAR model: lambda: estimated spatially smoothed rate region-group-time. lambda array real numbers dimensions num_region x num_group x num_time. support (0, 1) method = \"binomial\" support (0, Inf) `method = “poisson”; beta: mean rate island-group-year logit- log-transformed scale. Islands sets regions exclusively share adjacency information. example, miadj, two islands represent counties Upper Peninsula Lower Peninsula. islands don’t touch , thus don’t share adjacency information. island assigned beta. beta array real numbers dimensions num_island x num_group x num_time; Z: spatiotemporal random effects. parameters induce smoothing counties, intensity smoothing dictated spatial covariance matrices G. Z array real numbers dimensions num_region x num_group x num_time; G: spatial covariance matrices. parameter determines intensity spatial smoothing performed Z represents strength relationship group given time period. G array temporally-evolving positive-definite symmetric matrices dimensions num_group x num_group x num_time; rho: temporal correlation. parameter decides strength relationship values time period t values time period t-1. matrix size num_group x 1 real numbers support [0,1]; tau2: non-spatial variance. parameter picks variance values lambda group. matrix size num_group x 1 positive real numbers; Ag: general spatial covariance matrix. parameter describes overall relationship groups across entire model used prior distribution matrices G. Ag positive-definite symmetric matrix dimensions num_group x num_group.","code":""},{"path":"/articles/RSTr-initialvalues.html","id":"initial-values-for-the-mcar-model","dir":"Articles","previous_headings":"Initial value specifications","what":"Initial values for the MCAR model","title":"08: Initial Values","text":"MCAR model utilizes majority initial values MSTCAR model. However, MCAR include initial_values rho Ag. Note specification MCAR model slightly different MSTCAR model. MCAR model run data containing several time periods, tau2 require values every time period along every group.","code":""},{"path":"/articles/RSTr-initialvalues.html","id":"initial-values-for-the-ucareucar-model","dir":"Articles","previous_headings":"Initial value specifications","what":"Initial values for the UCAR/EUCAR model","title":"08: Initial Values","text":"UCAR models smallest set initial values, using lambda, beta, Z, tau2 MCAR model. Similar MCAR, UCAR model run multiple groups time periods, tau2 requires values every group time period present. new initial value UCAR models sig2, takes place G MCAR MSTCAR models: sig2 represents spatial variance UCAR/EUCAR model. parameter picks variance values Z group. matrix size num_group x num_time positive real numbers.","code":""},{"path":"/articles/RSTr-models.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Appendix A: The CAR Hierarchical Models","text":"vignette, outline hierarchical models used RSTr package, along full-conditional distributions used update.","code":""},{"path":"/articles/RSTr-models.html","id":"the-ucar-hierarchical-model","dir":"Articles","previous_headings":"","what":"The UCAR Hierarchical Model","title":"Appendix A: The CAR Hierarchical Models","text":"UCAR model used RSTr based model developed Besag, York, Mollié (1991) modifications using inverse transform sampling restricted informativeness based Quick, et al. (2021): models using method = \"binomial\", \\[ \\begin{split} Y_{} &\\sim \\text{Binomial}(n_{}, \\lambda_{}) \\\\ \\theta_{} &= \\text{Logit}(\\lambda_{}) \\\\ \\end{split} \\] models using method = \"poisson\", \\[   \\begin{split} Y_{} &\\sim \\text{Poisson}(n_{} \\lambda_{}) \\\\ \\theta_{} &= \\text{Log}(\\lambda_{}) \\\\ \\end{split} \\] models, \\[ \\begin{split} \\theta_{} &\\sim \\text{Normal}(\\beta_{j} + Z_{}, \\tau^2), \\\\ &=\\{1,...,N_{s}\\},\\ j =\\{1,...,N_{}\\} \\\\ p(\\beta_{j}) &\\propto 1 \\\\ Z &\\sim \\text{CAR}(\\sigma^2) \\\\ \\sigma^2 &\\sim \\text{InvGamma}(a_\\sigma,b_\\sigma) \\\\ \\tau^2 &\\sim \\text{InvGamma}(a_\\tau,b_\\tau) \\end{split} \\]","code":""},{"path":"/articles/RSTr-models.html","id":"the-mcar-hierarchical-model","dir":"Articles","previous_headings":"","what":"The MCAR Hierarchical Model","title":"Appendix A: The CAR Hierarchical Models","text":"MCAR model used RSTr based model developed Gelfand Vounatsou (2003): models using method = \"binomial\", \\[ \\begin{split} Y_{ik} &\\sim \\text{Binomial}(n_{ik}, \\lambda_{ik}) \\\\ \\theta_{ik} &= \\text{Logit}(\\lambda_{ik}) \\\\ \\end{split} \\] models using method = \"poisson\", \\[ \\begin{split} Y_{ik} &\\sim \\text{Poisson}(n_{ik}, \\lambda_{ik}) \\\\ \\theta_{ik} &= \\text{Log}(\\lambda_{ik}) \\\\ \\end{split} \\] models, \\[ \\begin{split} \\theta_{ik} &\\sim \\text{Normal}(\\beta_{jk} + Z_{ik}, \\tau_k^2), \\\\ &=\\{1,...,N_s\\}, k =\\{1,...,N_{g}\\}, j=\\{1,...,N_{}\\} \\\\ p(\\beta_{jk}) &\\propto 1 \\\\ Z &\\sim \\text{CAR}(G) \\\\ G &\\sim \\text{InvWishart}(\\nu,G_0) \\\\ \\tau^2 &\\sim \\text{InvGamma}(a_\\tau,b_\\tau) \\end{split} \\]","code":""},{"path":"/articles/RSTr-models.html","id":"the-mstcar-hierarchical-model","dir":"Articles","previous_headings":"","what":"The MSTCAR Hierarchical Model","title":"Appendix A: The CAR Hierarchical Models","text":"MSTCAR model used RSTr based model developed Quick, et al. (2017): models using method = \"binomial\", \\[ \\begin{split} Y_{ikt} &\\sim \\text{Binomial}(n_{ikt}, \\lambda_{ikt}) \\\\ \\theta_{ikt} &= \\text{Logit}(\\lambda_{ikt}) \\\\ \\end{split} \\] models using method = \"poisson\", \\[ \\begin{split} Y_{ikt} &\\sim \\text{Poisson}(n_{ikt} \\lambda_{ikt}) \\\\ \\theta_{ikt} &= \\text{Log}(\\lambda_{ikt}) \\\\ \\end{split} \\] models, \\[ \\begin{split} \\theta_{ikt} &\\sim \\text{Normal}(\\beta_{jkt} + Z_{ikt}, \\tau_k^2), \\\\ &=\\{1,...,N_s\\},\\ k =\\{1,...,N_g\\},\\ t=\\{1,...,N_t\\},\\ j=\\{1,...,N_{}\\} \\\\ p(\\beta_{j}) &\\propto 1 \\\\ Z &\\sim \\text{MSTCAR}(\\mathcal{G}, \\mathcal{R}), \\ \\mathcal{G}=\\{G_1,...,G_{N_t}\\}, \\ \\mathcal{R}=\\{R_1,...,R_{N_g}\\} \\\\ G_t &\\sim \\text{InvWishart}(A_G, \\nu) \\\\ A_G &\\sim \\text{Wishart}(A_{G_0}, \\nu_0) \\\\ R_k &= \\text{AR}(1,\\rho_k) \\\\ \\rho_k &\\sim \\text{Beta}(a_{\\rho}, b_{\\rho}) \\\\ \\tau_k^2 &\\sim \\text{InvGamma}(a_\\tau,b_\\tau) \\end{split} \\]","code":""},{"path":"/articles/RSTr-priors.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"09: Priors","text":"priors list specifying priors various hyperparameters auxiliary values model. default, values specified according literature, RSTr allows capability specifying priors. wish provide priors, note don’t specify priors parameters want specify - undefined priors defined default values. example, can specify priors lambda_sd values generated . However, one value specified certain parameter priors, values must specified parameter priors: , example, define priors just one year lambda_sd. Finally, values included priors list aren’t aligned names ignored.","code":""},{"path":"/articles/RSTr-priors.html","id":"prior-specifications","dir":"Articles","previous_headings":"","what":"Prior specifications","title":"09: Priors","text":"models RSTr share many priors, couple models initial_values unique . potential priors presented .","code":""},{"path":"/articles/RSTr-priors.html","id":"priors-for-the-mstcar-model","dir":"Articles","previous_headings":"Prior specifications","what":"Priors for the MSTCAR model","title":"09: Priors","text":"following priors used MSTCAR model: Ag_scale Ag_df: scale degrees freedom priors used Wishart-distributed random variable Ag. Ag_scale positive-definite symmetric matrix Ag_df double least size num_group; G_scale G_df: scale degrees freedom priors used Inverse-Wishart distributed matrix slices random variable G. G_scale positive-definite symmetric matrix G_df double least size num_group; tau_a tau_b: rate scale priors used Inverse-Gamma distributed random variable tau2. tau_a tau_b must positive real numbers; rho_a rho_b: shape priors used Beta-distributed random variable rho. rho_a rho_b must positive real numbers; lambda_sd: array positive real numbers describing candidate standard deviation Metropolis update estimated rates lambda. values adaptively updated start batch; rho_sd: vector positive real numbers describing candidate standard deviation Metropolis update temporal correlation rho. values adaptively updated start batch. Note used update_rho = TRUE.","code":""},{"path":"/articles/RSTr-priors.html","id":"priors-for-the-mcar-model","dir":"Articles","previous_headings":"Prior specifications","what":"Priors for the MCAR model","title":"09: Priors","text":"MCAR model shares priors MSTCAR model, include following: Ag_scale, Ag_df, rho_a, rho_b, rho_sd.","code":""},{"path":"/articles/RSTr-priors.html","id":"priors-for-the-ucareucar-model","dir":"Articles","previous_headings":"Prior specifications","what":"Priors for the UCAR/EUCAR model","title":"09: Priors","text":"UCAR models include following : lambda_sd, tau_a, tau_b. UCAR models also take priors sig_a sig_b, hold similar shape restriction tau_a tau_b.","code":""},{"path":"/articles/RSTr-reliability.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"05: Generating Estimates: Reliability and Suppression","text":"Though RSTr designed stabilize low-population regions, limit amount information model can gather, estimates exceedingly low-population regions may -smoothed. address issues, can establish criteria indicate whether estimates reliable enough display. vignette, take deep dive estimate reliability showcase can use reliability criteria suppress estimates suppress_estimates().","code":""},{"path":"/articles/RSTr-reliability.html","id":"traceplots","dir":"Articles","previous_headings":"Overview","what":"Traceplots","title":"05: Generating Estimates: Reliability and Suppression","text":"Let’s quickly demonstrate importance reliability metrics comparing traceplots high- low-population counties:  , two traceplots representing sample values time given county-group-year. left, can see traceplot highest-population county, right traceplot lowest-population county. traceplot also includes red line representing mean event rate county-group-year. Note traceplots, mean line nearby plots, either higher lower general trend, indicating rates counties attenuated thanks spatial smoothing. traceplot left exactly want see: clearly fluctuating around certain value. right traceplot, however, bit less favorable: value doesn’t seem want stabilize jumps values course model. However, rate naturally high, intensity fluctuation isn’t shocking. Smaller counties like one shown demonstrate limits RSTr: samples hover around single value iterations, estimated values get county-group-year right reliable estimates left due large variability samples gathered. Estimates like need standard measures reliability. Reliability can easily tested CAR models using two criteria: Relative precision: Quick, et al 2024, relative precision measured ratio posterior median credible interval. estimate’s ratio less 1, estimate considered unreliable level credibility. Effectively, means unreliable estimates spread samples larger value estimate ; Population counts: limitations RSTr’s models gather information low-population areas, estimates region fall specified threshold considered unreliable, regardless relative precision. Use judgment setting threshold depending kind data working : example, 1,000 population generally good rule thumb mortality data, whereas appropriate cutoff birth data closer 100. Note population count metric applies unrestricted models; enhancements restricted CAR models mean don’t need criterion evaluating reliability. Let’s get reliability metrics dataset. mstcar() function automatically generates credible intervals relative precisions based perc_ci argument:  , specify perc_ci = 0.95, means relative precision estimates based 95% credible interval. want generate suppressed estimates, can simply input RSTr model object suppress_estimates() function. Since using MSTCAR model, specify population threshold suppress counties small population counts: default, suppress_estimates() suppress based population counts, specifying type = \"event\", can alternatively use event count threshold. helpful maintaining consistency datasets suppress events instead population, CDC WONDER. Notice first two regions 35-44 age group suppressed; first suppressed population (964) second suppressed relative precision (0.925). Now, can map county estimates suppression:  suppressed maps highlight important benefit age-standardizing: can combine age groups bolster relative precisions increase total population groups, increasing values suppression criteria. Let’s age-standardize 35-64 see counties suppressed: RSTr model object remembers ’ve suppressed estimates automatically performs suppression age-standardized estimates. Let’s map age-standardized rates:  increase CI width 0.50 0.95 0.99 0.995, reliability criteria becomes stringent counties become grayed . important find good balance credible interval choice displaying estimates; traditionally-used credible interval 95% provides happy medium two factors.","code":"mod_mst <- mstcar(name = \"my_test_model\", data = miheart, adjacency = miadj, seed = 1234, perc_ci = 0.95) #> Starting sampler on Batch 1 at Thu Dec 11 00:06:43 #> Generating estimates... #> Model finished at Thu Dec 11 00:07:12 mod_mst <- suppress_estimates(mod_mst, threshold = 1e3) mod_mst #> RSTr object: #>  #> Model name: my_test_model  #> Model type: MSTCAR  #> Data likelihood: binomial  #> Estimate Credible Interval: 95%  #> Number of geographic units: 83  #> Number of samples: 6000  #> Estimates age-standardized: No  #> Estimates suppressed: Yes  #> Number of reliable rates: 3605 / 4980 (72.4%) estimates <- get_estimates(mod_mst) head(estimates) #>   county group year  medians medians_suppressed credible_interval_lower #> 1  26001 35-44 1979 41.98634                 NA                29.79605 #> 2  26003 35-44 1979 51.00178                 NA                37.86450 #> 3  26005 35-44 1979 23.76272           23.76272                16.29719 #> 4  26007 35-44 1979 33.61042           33.61042                24.15788 #> 5  26009 35-44 1979 29.70584           29.70584                22.96456 #> 6  26011 35-44 1979 38.17390                 NA                24.89862 #>   credible_interval_upper relative_precision events population #> 1                56.17417          1.5917110      1        964 #> 2               119.49006          0.6248260      1       1011 #> 3                33.58478          1.3745537      0       9110 #> 4                45.44376          1.5790005      0       3650 #> 5                39.27994          1.8207267      0       1763 #> 6                65.99126          0.9289717      0       1470 library(ggplot2) est_3544 <- estimates$medians_suppressed[estimates$group == \"35-44\" & estimates$year == \"1988\"] ggplot(mishp) +   geom_sf(aes(fill = est_3544)) +   labs(     title = \"Smoothed Myocardial Infarction Death Rates in MI, Ages 35-44, 1988\",     fill = \"Deaths per 100,000\"   ) +   scale_fill_viridis_c() +   theme_void() std_pop <- c(113154, 100640, 95799) mod_mst <- age_standardize(mod_mst, std_pop, new_name = \"35-64\", groups = c(\"35-44\", \"45-54\", \"55-64\")) estimates <- get_estimates(mod_mst) est_3564 <- estimates$medians_suppressed[estimates$group == \"35-64\" & estimates$year == \"1988\"] ggplot(mishp) +   geom_sf(aes(fill = est_3564)) +   labs(     title = \"Smoothed Myocardial Infarction Death Rates in MI, Ages 35-64, 1988\",     fill = \"Deaths per 100,000\"   ) +   scale_fill_viridis_c() +   theme_void()"},{"path":"/articles/RSTr-reliability.html","id":"final-thoughts","dir":"Articles","previous_headings":"","what":"Final thoughts","title":"05: Generating Estimates: Reliability and Suppression","text":"vignette, investigated measures reliability observed reliability measures change data suppressed. vignette concludes main sections using functions RSTr package. reading , able prepare event adjacency data, configure model necessary, age-standardize estimates, determine estimates reliable. interested advanced features RSTr involving sample processing, read vignette(\"RSTr-samples\"); ’d like information defining custom initial_values priors, check vignette(\"RSTr-initialvalues\") vignette(\"RSTr-priors\"), respectively; interested learning MSTCAR model works, read vignette(\"RSTr-models\").","code":""},{"path":"/articles/RSTr-samples.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"07: Sample Processing","text":"first series vignettes, worked high-level wrapper functions like age_standardize(), suppress_estimates(), get_estimates(). vignette, working functions underlie wrappers manually generating estimates, unlocking powerful capabilities RSTr. begin, note functions make direct changes RSTr model object. can manually save estimates model object, estimates automatically added. exchange power sample processing, lose convenience afforded us wrapper functions.","code":""},{"path":"/articles/RSTr-samples.html","id":"the-load_samples-function","dir":"Articles","previous_headings":"","what":"The load_samples() function","title":"07: Sample Processing","text":"begin, let’s generate samples new model:","code":"mod_mst <- mstcar(name = \"my_test_model\", data = miheart, adjacency = miadj, seed = 1234) #> Starting sampler on Batch 1 at Thu Dec 11 00:07:17 #> Generating estimates... #> Model finished at Thu Dec 11 00:07:46"},{"path":"/articles/RSTr-samples.html","id":"the-load_samples-function-1","dir":"Articles","previous_headings":"","what":"The load_samples() function","title":"07: Sample Processing","text":"mstcar() tells model finished running, can import samples R using load_samples(). load_samples() takes four arguments: RSTr_obj: RSTr model object; param: parameter import samples ; burn: Specifies burn-period samples. allows model time stabilize using samples generate estimates. default, burn-period 2000 samples. dimnames saved data applied samples appropriate. , pull lambda samples test Michigan dataset 2000-sample burn-period (specified default arguments). also multiply 100,000 common display mortality rates per 100,000 individuals:","code":"samples <- load_samples(mod_mst, param = \"lambda\", burn = 2000) * 1e5"},{"path":"/articles/RSTr-samples.html","id":"group-aggregation","dir":"Articles","previous_headings":"The load_samples() function","what":"Group aggregation","title":"07: Sample Processing","text":"many cases, want aggregate data across non-age groups, looking prevalence estimates simply consolidate non-age sociodemographic groups. Michigan dataset, 10 years data can consolidate look prevalence. cases, need pull population array weight. First, need check margin contains year information using dim() function: samples array four margins dimensions 83, 6, 10, 400, representing spatial regions, age groups, time periods, iterations, respectively. Let’s set variable margin_time represent time period margin aggregate samples estimates across 1988-1988 using aggregate_samples() function. population data needed weight samples can pulled RSTr model object: Now, standalone sample array 1988-1988 samples. interested individual year data prevalence data? can alternatively bind new samples main samples array adding values bind_new new_name arguments: Group-aggregation feature unique samples; group-aggregation performed model objects.","code":"dim(samples) #> [1]  83   6  10 400 margin_time <- 3 pop <- mod_mst$data$n samples_7988 <- aggregate_samples(samples, pop, margin_time) samples <- aggregate_samples(samples, pop, margin_time, bind_new = TRUE, new_name = \"1979-1988\")"},{"path":"/articles/RSTr-samples.html","id":"age-standardization","dir":"Articles","previous_headings":"The load_samples() function","what":"Age-standardization","title":"07: Sample Processing","text":"process age-standardization similar group-aggregation, requires bit nuance use. can also use samples age-standardize 35-64 group. Like , since using data 1988-1988, can use 1980 standard populations NIH generate std_pop vector: std_pop generated, need check margin contains age group information using dim() function: age groups lay along second margin. Let’s set variable margin_age standardize samples estimates across ages 35-64 using standardize_samples() function: Note may times groups stratified age sociodemographic groups. cases, ’ll refactor sample array age groups separated groups age-standardization, using .data.frame.table() conjunction xtabs(). Now, standalone array age-standardized 35-64 age group. Similarly aggregate_samples(), can alternatively consolidate main samples array adding values bind_new new_name arguments: Now, samples samples aggregated year age-standardized, matching array values pop. Note plan mix non-age aggregation age-standardization, age-standardization aggregation, age-standardization first alter results aggregation done afterward.","code":"age <- c(\"35-44\", \"45-54\", \"55-64\") std_pop <- c(113154, 100640, 95799) dim(samples) #> [1]  83   6  11 400 margin_age <- 2 groups <- c(\"35-44\", \"45-54\", \"55-64\") samples_3564 <- standardize_samples(samples, std_pop, margin_age, groups) samples <- standardize_samples(   samples,   std_pop,   margin_age,   groups,   bind_new = TRUE,   new_name = \"35-64\" )"},{"path":"/articles/RSTr-samples.html","id":"estimates-and-reliability","dir":"Articles","previous_headings":"","what":"Estimates and Reliability","title":"07: Sample Processing","text":"get medians, simply put samples get_medians(): Let’s get reliability metrics dataset. First, let’s generate relative precisions 95% credibility using get_credible_interval() get_relative_precision() functions, create logical array tells us estimates unreliable: Now, let’s generate similar logical array populations less 1000 use criteria create set suppressed medians. median suppressed meets either two criteria. Note since samples age-standardized, also extend pop array match size using aggregate_count() function: Let’s now map suppressed estimates:  samples available, can generate estimates different credible intervals without re-run model:  can even use samples learn data. Let’s say interested figuring rate estimate statistically significantly greater less overall state rate. can calculate crude state rate 35-44 age group, compare samples. Note can make statistical significance comparisons, even rates unreliable:  map, can see much northern Lower Peninsula significantly lower state rate, whereas southern portion LP many places significantly higher rates. western Upper Peninsula also shows areas significantly higher rates.","code":"medians <- get_medians(samples) ci <- get_credible_interval(sample = samples, perc_ci = 0.95) rel_prec <- get_relative_precision(medians, ci) low_rel_prec <- rel_prec < 1 pop <- aggregate_count(pop, margin_age, groups = 1:3, bind_new = TRUE, new_name = \"35-64\") pop <- aggregate_count(pop, margin_time, bind_new = TRUE, new_name = \"1988-1988\") low_population <- pop < 1000 medians_supp <- medians medians_supp[low_rel_prec | low_population] <- NA library(ggplot2) est_3544 <- medians_supp[, \"35-44\", \"1988\"]  ggplot(mishp) +   geom_sf(aes(fill = est_3544)) +   labs(     title = \"Smoothed Myocardial Infarction Death Rates in MI, Ages 35-44, 1988\",     fill = \"Deaths per 100,000\"   ) +   scale_fill_viridis_c() +   theme_void() ci <- get_credible_interval(samples, 0.995) rel_prec50 <- get_relative_precision(medians, ci) low_rel_prec <- rel_prec50 < 1 medians_supp <- medians medians_supp[low_rel_prec | low_population] <- NA  est_3544 <- medians_supp[, \"35-44\", \"1988\"]  ggplot(mishp) +   geom_sf(aes(fill = est_3544)) +   labs(     title = \"Smoothed Myocardial Infarction Death Rates in MI, 99.5% CI, Ages 35-44, 1988\",     fill = \"Deaths per 100,000\"   ) +   scale_fill_viridis_c() +   theme_void() crude_3544 <- sum(mod_mst$data$Y[, \"35-44\", \"1988\"]) / sum(mod_mst$data$n[, \"35-44\", \"1988\"]) * 1e5 sample_3544 <- samples[, \"35-44\", \"1988\", ] p_higher <- apply(sample_3544, 1, \\(county) mean(county > crude_3544)) * 100  ggplot(mishp) +   geom_sf(aes(fill = p_higher)) +   labs(     title = \"Probability that County Rate > State Rate MI, Ages 35-44, 1988\",     fill = \"Probability\"   ) +   scale_fill_continuous(palette = \"RdBu\", trans = \"reverse\") +   theme_void()"},{"path":"/articles/RSTr-samples.html","id":"closing-thoughts","dir":"Articles","previous_headings":"","what":"Closing Thoughts","title":"07: Sample Processing","text":"vignette, discussed features unique sample processing like aggregate_samples(), granual control samples, extensions analysis using samples.","code":""},{"path":"/articles/RSTr-troubleshoot.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Appendix B: Troubleshooting","text":"*car() functions include checks ensure data set way model can use. checks notice something incompatible model, error displayed console. , list possible error MSTCAR model, including reasoning ways check fix inputs.","code":""},{"path":"/articles/RSTr-troubleshoot.html","id":"generic-errors-and-warnings","dir":"Articles","previous_headings":"","what":"Generic errors and warnings","title":"Appendix B: Troubleshooting","text":"checks run data check general information, extraneous list objects used model. cases, RSTr use parts dataset. recommended remove datasets model prevent unnecessary clutter.","code":""},{"path":"/articles/RSTr-troubleshoot.html","id":"errors-and-warnings-with-list-data","dir":"Articles","previous_headings":"","what":"Errors and warnings with list data","title":"Appendix B: Troubleshooting","text":"One objects missing list 'data': data object requires list two objects: array Y mortality counts array n population counts. needed perform parameter updates inside MSTCAR model. Check names(data) see vector names exists inside array fix names accordingly. Data dimensions. Ensure dim(Y) == dim(n): error occurs arrays fed data list size. Use dim() function check dimensions two arrays line . can use aperm() function rearrange arrays set dimensions different margins. Invalid Y/n values. Check Y's/n's least 0 finite: NA NULL accepted values Y, Y n must comprised positive finite values. Check data summary() quick look minimum values.","code":""},{"path":"/articles/RSTr-troubleshoot.html","id":"errors-and-warnings-with-list-spatial_data","dir":"Articles","previous_headings":"","what":"Errors and warnings with list spatial_data","title":"Appendix B: Troubleshooting","text":"Adjacency different length data. Ensure length(adjacency) == dim(Y)[1]: Adjacency information must present regions. Look length adjacency information: line number rows Y n arrays. regions neighbors. Ensure regions least one neighbor: region neighbor, model run. working list adjacency information, can first check regions neighbors running (lapply(adjacency, \\(x) (x == 0))) fixing regions accordingly. assistance fixing adjacency information, read vignette(\"RSTr-adjacency\").","code":""},{"path":"/articles/RSTr-troubleshoot.html","id":"initial_values-and-priors","dir":"Articles","previous_headings":"","what":"initial_values and priors","title":"Appendix B: Troubleshooting","text":"troubleshooting inputs initial_values priors, reference vignette(\"RSTr-initialvalues\") vignette(\"RSTr-priors\"), respectively.","code":""},{"path":"/articles/RSTr-troubleshoot.html","id":"ignore_checks","dir":"Articles","previous_headings":"","what":"ignore_checks","title":"Appendix B: Troubleshooting","text":"input data certain correct, yet receiving error messages anyway, set ignore_checks argument TRUE setting model skip data checks. recommended easy break RSTr data isn’t properly checked, used last resort using RSTr.","code":""},{"path":"/articles/RSTr.html","id":"sec-overview","dir":"Articles","previous_headings":"","what":"Overview","title":"An Introduction to the RSTr Package","text":"RSTr package tool provides host Bayesian spatiotemporal models conjunction C++ quickly easily generate spatially-smoothed age-standardized estimates spatial data. vignette introduces basics RSTr package shows apply basic functions included example data get small area estimates.","code":""},{"path":"/articles/RSTr.html","id":"sec-models","dir":"Articles","previous_headings":"","what":"Models","title":"An Introduction to the RSTr Package","text":"models provided RSTr package based Besag, York, Mollié (1991) Conditional Autoregressive (CAR) model (heretofore referred “Univariate CAR” “UCAR” model), spatially smooths data incorporating information event population counts neighboring geographic units (counties, census tracts, etc.). degree spatial smoothing determined spatial region’s respective population size. CAR model can extended several levels complexity, depending input data: Univariate CAR (UCAR): Spatially smooths across geographies; Enhanced Univariate CAR (EUCAR): Spatially smooths across geographies prevents -smoothing; Multivariate CAR (MCAR): Spatially smooths across geographies sociodemographic groups; Multivariate Spatiotemporal CAR (MSTCAR): Spatially smooths across geographies, sociodemographic groups, time periods. vignette, demonstrate RSTr’s functionality MSTCAR model.","code":""},{"path":"/articles/RSTr.html","id":"sec-enhanced-models","dir":"Articles","previous_headings":"Models","what":"Enhanced models to prevent over-smoothing","title":"An Introduction to the RSTr Package","text":"problem CAR models pointed Quick, et al. (2021) -smoothing due informativeness BYM model. RSTr package provides enhancements UCAR models Poisson- binomial-distributed data prevent -smoothing restricting model informativeness eucar() function. Enhancements MCAR MSTCAR models progress, incorporated RSTr package developed.","code":""},{"path":"/articles/RSTr.html","id":"sec-datasets","dir":"Articles","previous_headings":"","what":"Datasets","title":"An Introduction to the RSTr Package","text":"RSTr comes three main datasets: miheart, miadj, mishp. miheart miadj related necessary components models, mishp shapefile helps map results. run MSTCAR model, two components necessary: Event counts parameter interest, stratified region, group, time period, corresponding population counts. data may binomial- Poisson-distributed. example dataset binomial-distributed myocardial infarction deaths six age groups 1979-1988 Michigan. Reference miheart see data looks ?miheart information dataset. information preparing event data, read vignette(\"RSTr-event\"). adjacency structure data. list tells RSTr regions neighbors one based region index (.e., order appear dataset). Reference miadj example adjacency structure list. information preparing adjacency data, read vignette(\"RSTr-adjacency\"). quick notes data setup: Event/population data must organized specific manner. RSTr’s models can accept three-dimensional arrays: MSTCAR model, example, spatial regions must rows, socio/demographic groups must columns, time periods must matrix slices. Additionally, event data’s regions listed order adjacency structure data. Every region must least one neighbor. adjacency structures must listed order count data.","code":""},{"path":"/articles/RSTr.html","id":"sec-functions","dir":"Articles","previous_headings":"","what":"Functions","title":"An Introduction to the RSTr Package","text":"RSTr comes set functions generate small area estimates dataset. brief overview basic functions purpose: *car(): Inputs data model specifics creates local folder associated files prepare sample generation; age_standardize(): Generates age-standardized estimates based user-specified age groups; suppress_estimates(): Suppresses estimates based reliability criteria; get_estimates(): Creates long table containing information region/group/time model.","code":""},{"path":[]},{"path":"/articles/RSTr.html","id":"mstcar","dir":"Articles","previous_headings":"Example Model","what":"mstcar()","title":"An Introduction to the RSTr Package","text":"understanding example datasets functions, can start running first model. example datasets set run ---box:  , use mstcar() function specify model. mstcar() accepts different arguments case: name argument specifies folder model data lives; data argument specifies event/population data; adjacency argument specifies adjacency structure; dir argument specifies directory save folder; seed argument specifies random seed replicability purposes. mstcar() creates folder named my_test_model R’s temporary directory containing folders hold batches outputs parameter update. Additionally, RSTr object holds information associated model (aside samples) created R environment temporary directory. samples saved R environment , given sufficiently large dataset, MSTCAR models can become large ’s impossible hold model samples RAM. Therefore, samples saved locally. want save model somewhere besides temporary directory future use, can specify folder dir argument. Note mstcar() accepts arguments used , ones needed get started. Priors initial values, example, can specified manually, outside scope vignette. also checks performed input data: something wrong, warnings error messages tell wrong fix . list diagnostic errors mean, read vignette(\"RSTr-troubleshooting\"). RSTr package works generating samples batches saving locally inside model directory retrieved model finished running. Generating samples batches helps facilitate tuning underlying MCMC algorithm helps avoid computational burden holding fraction total samples memory given time. RSTr runs 6,000 iterations split 60 batches size 100 . batches thinned every 10 iterations default, lambdas (.k.., rate estimates) tend exhibit autocorrelation. Moreover, thinning saves space writing samples hard drive, batches larger models can balloon gigabytes size thinning. Console outputs show current batch number, progress within batch, elapsed time. model Rds file updated sampler progresses case need reload model later date. model crashes reason R closes model run, model Rds file keep track current batch pick back left re-run. mstcar() running, R plot window show traceplots selection estimates check stability diagnose potential issues. want learn mstcar() model functions, read vignette(\"RSTr-car\").","code":"mod_mst <- mstcar(   name = \"my_test_model\",   data = miheart,   adjacency = miadj,   dir = tempdir(),   seed = 1234 ) #> Starting sampler on Batch 1 at Thu Dec 11 00:08:04 #> Generating estimates... #> Model finished at Thu Dec 11 00:08:33"},{"path":"/articles/RSTr.html","id":"sec-getestimates","dir":"Articles","previous_headings":"Example Model","what":"get_estimates()","title":"An Introduction to the RSTr Package","text":"mstcar() takes care vast majority model preparation: within function, model set , samples generated, medians estimated. function finishes, can get overview model: , get birds-eye-view model, including model used (MSTCAR), data likelihood type, number geographic units, whether estimates age-standardized suppressed along reliability criteria. get_estimates() function, can get detailed look estimates. type mortality data, common observe rates per 100,000 population, set rates_per argument get_estimates() 1e5: mst_estimates object contains -depth information model estimates, including medians, credible intervals, relative precisions, event/population counts; region, group, time period columns also provided.","code":"mod_mst #> RSTr object: #>  #> Model name: my_test_model  #> Model type: MSTCAR  #> Data likelihood: binomial  #> Estimate Credible Interval: 95%  #> Number of geographic units: 83  #> Number of samples: 6000  #> Estimates age-standardized: No  #> Estimates suppressed: No mst_estimates <- get_estimates(mod_mst, rates_per = 1e5) head(mst_estimates) #>   county group year  medians credible_interval_lower credible_interval_upper #> 1  26001 35-44 1979 41.98634                29.79605                56.17417 #> 2  26003 35-44 1979 51.00178                37.86450               119.49006 #> 3  26005 35-44 1979 23.76272                16.29719                33.58478 #> 4  26007 35-44 1979 33.61042                24.15788                45.44376 #> 5  26009 35-44 1979 29.70584                22.96456                39.27994 #> 6  26011 35-44 1979 38.17390                24.89862                65.99126 #>   relative_precision events population #> 1          1.5917110      1        964 #> 2          0.6248260      1       1011 #> 3          1.3745537      0       9110 #> 4          1.5790005      0       3650 #> 5          1.8207267      0       1763 #> 6          0.9289717      0       1470"},{"path":"/articles/RSTr.html","id":"sec-agestandardize","dir":"Articles","previous_headings":"Example Model","what":"age_standardize()","title":"An Introduction to the RSTr Package","text":"One important features RSTr package ability easily generate age-standardized estimates. Let’s say want get age-standardized estimates 35-64 age group; model, use age_standardize() function, specify groups interest, associated standard populations, name want give . Since using data 1979-1988, can use 1980 standard populations NIH generate std_pop standard population vector: Notice now mod_mst object indicates age-standardized estimates names age-standardized groups. Now, get_estimates(mod_mst) shows age-standardized estimates. want see instead, can set argument standardized = FALSE.","code":"std_pop <- c(68775, 34116, 9888) mod_mst <- age_standardize(mod_mst, std_pop, new_name = \"35-64\", groups = c(\"35-44\", \"45-54\", \"55-64\")) mod_mst #> RSTr object: #>  #> Model name: my_test_model  #> Model type: MSTCAR  #> Data likelihood: binomial  #> Estimate Credible Interval: 95%  #> Number of geographic units: 83  #> Number of samples: 6000  #> Estimates age-standardized: Yes  #> Age-standardized groups: 35-64  #> Estimates suppressed: No mst_estimates_as <- get_estimates(mod_mst) head(mst_estimates_as) #>   county group year   medians credible_interval_lower credible_interval_upper #> 1  26001 35-64 1979 107.15247                87.92325               127.88946 #> 2  26003 35-64 1979 146.65258               119.93045               195.45817 #> 3  26005 35-64 1979  71.08941                57.78063                81.64427 #> 4  26007 35-64 1979  87.54041                73.16101               109.51904 #> 5  26009 35-64 1979  88.98631                74.88835               107.03585 #> 6  26011 35-64 1979 112.27379                92.11683               145.85171 #>   relative_precision events population #> 1           2.681076      7       3353 #> 2           1.941706     12       3105 #> 3           2.978984     27      23926 #> 4           2.407732     15      10000 #> 5           2.768063     11       5152 #> 6           2.089402      8       4517"},{"path":"/articles/RSTr.html","id":"sec-suppressestimates","dir":"Articles","previous_headings":"Example Model","what":"suppress_estimates()","title":"An Introduction to the RSTr Package","text":"main benefit RSTr generating reliable estimates small-population areas, guarantee estimates generated mstcar() reliable. Therefore, prudent suppress estimates deemed unreliable. MSTCAR models, can use two criteria test reliability: relative precision (.e., ratio median estimate width credible interval) population count. relative precisions, aim value least 1 (.e., median larger width credible interval), myocardial infarction death rates, typically aim population threshold least 1,000. Using suppress_estimates() function, can generate suppressed estimates age-standardized rates: mod_mst now shows us estimates suppressed indicates number reliable rates. want learn get_estimates(), age_standardize(), suppress_estimates(), read vignette(\"RSTr-estimates\").","code":"mod_mst <- suppress_estimates(mod_mst, threshold = 1e3) mod_mst #> RSTr object: #>  #> Model name: my_test_model  #> Model type: MSTCAR  #> Data likelihood: binomial  #> Estimate Credible Interval: 95%  #> Number of geographic units: 83  #> Number of samples: 6000  #> Estimates age-standardized: Yes  #> Age-standardized groups: 35-64  #> Estimates suppressed: Yes  #> Number of reliable age-standardized rates: 819 / 830 (98.7%) mst_estimates_as <- get_estimates(mod_mst) head(mst_estimates_as) #>   county group year   medians medians_suppressed credible_interval_lower #> 1  26001 35-64 1979 107.15247          107.15247                87.92325 #> 2  26003 35-64 1979 146.65258          146.65258               119.93045 #> 3  26005 35-64 1979  71.08941           71.08941                57.78063 #> 4  26007 35-64 1979  87.54041           87.54041                73.16101 #> 5  26009 35-64 1979  88.98631           88.98631                74.88835 #> 6  26011 35-64 1979 112.27379          112.27379                92.11683 #>   credible_interval_upper relative_precision events population #> 1               127.88946           2.681076      7       3353 #> 2               195.45817           1.941706     12       3105 #> 3                81.64427           2.978984     27      23926 #> 4               109.51904           2.407732     15      10000 #> 5               107.03585           2.768063     11       5152 #> 6               145.85171           2.089402      8       4517"},{"path":"/articles/RSTr.html","id":"illustrative-example-mapping-estimates","dir":"Articles","previous_headings":"","what":"Illustrative Example: Mapping Estimates","title":"An Introduction to the RSTr Package","text":"can get better picture geographic patterns data map. Using ggplot (favorite mapping package), Let’s see (non-age-standardized) estimates smoothed:   map helps us see RSTr smooths rates. First, notice range two plots different: smoothed map smaller range RSTr stabilizes high low extreme values usually caused low population counts. Also, notice transitions high-rate low-rate regions gradual smoothed map. consequence using neighboring regions inform stabilize estimates. , can get better idea maps contrast. example, first map, largest region interest middle portion Lower Peninsula (LP), smoothed map, much area attenuated rates. flip side, many areas Upper Peninsula () relatively lower rates first map, can see smoothed map highest rate state . higher-rate areas LP focused around counties Saginaw Bay east, indicating areas may require attention previously thought. kinds inferences can made using estimates generated RSTr package main motivation running spatiotemporal model.","code":"library(ggplot2) # Original Myocardial Infarction Death Rates in MI, Ages 35-64, 1988 estimates_88 <- mst_estimates_as[mst_estimates_as$year == \"1988\", ] estimates_3564 <- estimates_88[estimates_88$group == \"35-64\", ] raw_3564 <- (estimates_3564$events / estimates_3564$population * 1e5) ggplot(mishp) +   geom_sf(aes(fill = raw_3564)) +   labs(     title = \"Raw Myocardial Infarction Death Rates in MI, Ages 65 and up, 1988\",     fill = \"Deaths per 100,000\"   ) +   scale_fill_viridis_c() +   theme_void() # Spatially Smoothed MI Death Rates in MI est_3564 <- estimates_3564$medians ggplot(mishp) +   geom_sf(aes(fill = est_3564)) +   labs(     title = \"Smoothed Myocardial Infarction Death Rates in MI, Ages 35-64, 1988\",     fill = \"Deaths per 100,000\"   ) +   scale_fill_viridis_c() +   theme_void()"},{"path":"/articles/RSTr.html","id":"closing-thoughts","dir":"Articles","previous_headings":"","what":"Closing Thoughts","title":"An Introduction to the RSTr Package","text":"vignette introduces inputting data mstcar() function, extracting estimates get_estimates() function, age-standardizing estimates age_standardize() function, suppressing estimates suppress_estimates() function, finally making map estimates gathered get_estimates() function. ’ve discussed just scratching surface RSTr package. package vignettes dive deeper intricacies component package. things together ensure get using RSTr.","code":""},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"David DeLara. Author, maintainer. Centers Disease Control Prevention. Author.           https://ror.org/042twtr12","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"DeLara D, Centers Disease Control Prevention (2025). RSTr: Rate Stabilizing Tool: Gibbs Samplers Bayesian Spatiotemporal CAR Models. R package version 0.9, https://cehi-code-repos.github.io/RSTr/.","code":"@Manual{,   title = {RSTr: Rate Stabilizing Tool: Gibbs Samplers for Bayesian Spatiotemporal CAR Models},   author = {David DeLara and {Centers for Disease Control and Prevention}},   year = {2025},   note = {R package version 0.9},   url = {https://cehi-code-repos.github.io/RSTr/}, }"},{"path":"/index.html","id":"rstr-","dir":"","previous_headings":"","what":"Rate Stabilizing Tool: Gibbs Samplers for Bayesian Spatiotemporal CAR Models","title":"Rate Stabilizing Tool: Gibbs Samplers for Bayesian Spatiotemporal CAR Models","text":"Rate Stabilizing Tool R Package (RSTr): Gibbs Samplers Bayesian Spatiotemporal CAR Models RSTr package tool uses Bayesian spatiotemporal models conjunction C++ help quickly easily generate spatially smoothed estimates spatiotemporal small area data. ArcGIS Python Toolbox, visit Rate Stabilizing Toolbox (RSTbx).","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Rate Stabilizing Tool: Gibbs Samplers for Bayesian Spatiotemporal CAR Models","text":"Windows users must first install RTools installing package source. may find useful use installr package install RTools like : can install development version RSTr. first time using RSTr, check vignette(\"RSTr\") learn use package.","code":"install.packages(\"installr\") installr::install.Rtools() devtools::install_github(\"CEHI-code-repos/RSTr\", build_vignettes = TRUE)"},{"path":"/index.html","id":"thanks","dir":"","previous_headings":"","what":"Thanks!","title":"Rate Stabilizing Tool: Gibbs Samplers for Bayesian Spatiotemporal CAR Models","text":"Thanks checking RSTr package. hope find useful spatiotemporal modeling! Please feel free give feedback bugs, ways make package accessible use, features ’d like see added package.","code":""},{"path":"/reference/RSTr-package.html","id":null,"dir":"Reference","previous_headings":"","what":"Rate Stabilizing Tool: Gibbs Samplers for Bayesian Spatiotemporal CAR Models — RSTr-package","title":"Rate Stabilizing Tool: Gibbs Samplers for Bayesian Spatiotemporal CAR Models — RSTr-package","text":"Takes Poisson Binomial discrete spatial data runs Gibbs sampler variety Spatiotemporal Conditional Autoregressive (CAR) models. Includes measures prevent estimate -smoothing restriction model informativeness select models. Also provides tools load output get median estimates. Implements methods Besag, York, Mollié (1991) \"Bayesian image restoration, two applications spatial statistics\" \\doi{10.1007/BF00116466}, Gelfand Vounatsou (2003) \"Proper multivariate conditional autoregressive models spatial data analysis\" doi:10.1093/biostatistics/4.1.11, Quick et al. (2017) \"Multivariate spatiotemporal modeling age-specific stroke mortality\" doi:10.1214/17-AOAS1068, Quick et al. (2021) \"Evaluating informativeness Besag-York-Mollié CAR model\" doi:10.1016/j.sste.2021.100420.","code":""},{"path":"/reference/RSTr-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Rate Stabilizing Tool: Gibbs Samplers for Bayesian Spatiotemporal CAR Models — RSTr-package","text":"RSTr package uses Bayesian spatiotemporal modeling spatially smooths discrete small-area event rates using information neighboring spatial regions. See `browseVignettes(\"RSTr\")` series tutorials basic usage RSTr functions.","code":""},{"path":"/reference/RSTr-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Rate Stabilizing Tool: Gibbs Samplers for Bayesian Spatiotemporal CAR Models — RSTr-package","text":"David DeLara [aut, cre] (ORCID:     <https://orcid.org/0000-0003-0485-7549>),   Centers Disease Control Prevention [aut]     (https://ror.org/042twtr12) Maintainer: David DeLara <sfq1@cdc.gov>","code":""},{"path":"/reference/RSTr-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Rate Stabilizing Tool: Gibbs Samplers for Bayesian Spatiotemporal CAR Models — RSTr-package","text":"Besag, J., York, J., Mollié, . (1991). Bayesian Image Restoration Two Applications Spatial Statistics (Discussion). Annals Institute Statistical Mathematics, 43, 1–59. doi:10.1007/BF00116466 Gelfand, . E., & Vounatsou, P. (2003). Proper multivariate conditional autoregressive models spatial data analysis. Biostatistics, 4(1), 11–25. doi:10.1093/biostatistics/4.1.11 Quick, et al. (2017). Multivariate spatiotemporal modeling age-specific stroke mortality. Annals Applied Statistics, 11(4), 2165–2177. doi:10.1214/17-AOAS1068 Quick, et al. (2021). Evaluating informativeness Besag-York-Mollié CAR model. Spatial Spatio-temporal Epidemiology, 37, 100420. doi:10.1016/j.sste.2021.100420","code":""},{"path":"/reference/add_neighbors.html","id":null,"dir":"Reference","previous_headings":"","what":"Add neighbors to adjacency information — add_neighbors","title":"Add neighbors to adjacency information — add_neighbors","text":"Modifies adjacency indicate neighs treated neighbors.","code":""},{"path":"/reference/add_neighbors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add neighbors to adjacency information — add_neighbors","text":"","code":"add_neighbors(adjacency, neighs)"},{"path":"/reference/add_neighbors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add neighbors to adjacency information — add_neighbors","text":"adjacency Adjacency information generated spdep::poly2nb(). neighs list regions mark adjacent. Accepts vector indices names assigned adjacency.","code":""},{"path":"/reference/add_neighbors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add neighbors to adjacency information — add_neighbors","text":"modified adjacency list.","code":""},{"path":"/reference/add_neighbors.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Add neighbors to adjacency information — add_neighbors","text":"add_neighbors() useful adjacency information generated spdep::poly2nb() indicates lone regions without links/neighbors, particularly island counties Hawaiian islands, Nantucket Massachusetts, San Juan Washington. Note add_neighbors() marks listed counties adjacent, set chaining counties first may connected last, several instances add_neighbors() needed.","code":""},{"path":"/reference/add_neighbors.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add neighbors to adjacency information — add_neighbors","text":"","code":"mamap <- sf::st_as_sf(mamap[order(mamap$GEOID), ]) ma_adj <- spdep::poly2nb(mamap) #> Warning: some observations have no neighbours; #> if this seems unexpected, try increasing the snap argument. #> Warning: neighbour object has 3 sub-graphs; #> if this sub-graph count seems unexpected, try increasing the snap argument. new_neighs <- c(1, 4, 10) # attach regions 1, 4, and 10 ma_adj <- add_neighbors(ma_adj, new_neighs)  # Add neighbors by FIPS code instead of index ma_adj <- suppressWarnings(spdep::poly2nb(mamap)) names(ma_adj) <- mamap$GEOID ma_adj <- add_neighbors(ma_adj, neighs = c(\"25001\", \"25007\", \"25019\"))  ma_adj <- suppressWarnings(spdep::poly2nb(mamap)) ma_adj <- add_neighbors(ma_adj, c(1, 4)) # only attach 1 and 4 ma_adj <- add_neighbors(ma_adj, c(4, 10)) # only attach 4 and 10"},{"path":"/reference/age_standardize.html","id":null,"dir":"Reference","previous_headings":"","what":"Age-standardize model objects — age_standardize","title":"Age-standardize model objects — age_standardize","text":"Age-standardizes samples using standard population RSTr model object.","code":""},{"path":"/reference/age_standardize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Age-standardize model objects — age_standardize","text":"","code":"age_standardize(RSTr_obj, std_pop, new_name, groups = NULL)"},{"path":"/reference/age_standardize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Age-standardize model objects — age_standardize","text":"RSTr_obj RSTr model object. std_pop vector standard populations. new_name name assign age-standardized group. groups vector either indices group vector strings group name. set NULL, use groups dataset.","code":""},{"path":"/reference/age_standardize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Age-standardize model objects — age_standardize","text":"RSTr object age-standardized estimates.","code":""},{"path":"/reference/age_standardize.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Age-standardize model objects — age_standardize","text":"","code":"std_pop <- c(113154, 100640, 95799) data_min <- lapply(miheart, \\(x) x[1:2, 1:3, 1:3]) adj_min <- list(2, 1) mod_mst <- mstcar(\"test\", data_min, adj_min, tempdir(), show_plots = FALSE, verbose = FALSE) # age-standardize by all age groups mod_mst <- age_standardize(mod_mst, std_pop, \"35-64\") # Add onto age-standardized estimates. Age-standardize only by the first two age groups mod_mst <- age_standardize(mod_mst, std_pop[1:2], \"35-54\", groups = 1:2)"},{"path":"/reference/aggregate_count.html","id":null,"dir":"Reference","previous_headings":"","what":"Aggregate count arrays — aggregate_count","title":"Aggregate count arrays — aggregate_count","text":"Sums counts event/population arrays. Useful manually generating group-aggregated/age-standardized estimates population threshold needed suppression.","code":""},{"path":"/reference/aggregate_count.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Aggregate count arrays — aggregate_count","text":"","code":"aggregate_count(   count,   margin,   groups = NULL,   bind_new = FALSE,   new_name = NULL )"},{"path":"/reference/aggregate_count.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Aggregate count arrays — aggregate_count","text":"count array aggregate. margin arrays, margin groups interest stratified. groups vector either indices group vector strings group name. set NULL, use groups dataset. bind_new set TRUE, bind array original sample dataset. Otherwise, generate standalone array samples. new_name name assign age-standardized group.","code":""},{"path":"/reference/aggregate_count.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Aggregate count arrays — aggregate_count","text":"array aggregated count data.","code":""},{"path":"/reference/aggregate_count.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Aggregate count arrays — aggregate_count","text":"","code":"margin_time <- 3 # aggregate population from all years for each county-group pop_7988 <- aggregate_count(miheart$n, margin_time) # aggregate population from 1980-1984 for each county-group pop_8084 <- aggregate_count(miheart$n, margin_time, groups = as.character(1980:1984)) # bind aggregated pop from all years to population data pop_agg <- aggregate_count(miheart$n, margin_time, bind_new = TRUE, new_name = \"1979-1988\")"},{"path":"/reference/aggregate_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Aggregate samples by non-age group — aggregate_samples","title":"Aggregate samples by non-age group — aggregate_samples","text":"Consolidates set samples non-age groups using population array create weighted-average samples.","code":""},{"path":"/reference/aggregate_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Aggregate samples by non-age group — aggregate_samples","text":"","code":"aggregate_samples(   sample,   pop,   margin,   groups = NULL,   bind_new = FALSE,   new_name = NULL )"},{"path":"/reference/aggregate_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Aggregate samples by non-age group — aggregate_samples","text":"sample array samples imported load_samples() pop population array used weighted averages. margin arrays, margin groups interest stratified. groups vector either indices group vector strings group name. set NULL, use groups dataset. bind_new set TRUE, bind array original sample dataset. Otherwise, generate standalone array samples. new_name name assign age-standardized group.","code":""},{"path":"/reference/aggregate_samples.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Aggregate samples by non-age group — aggregate_samples","text":"array weighted-average samples.","code":""},{"path":"/reference/aggregate_samples.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Aggregate samples by non-age group — aggregate_samples","text":"aggregate_samples() meant non-age group data, spatial regions, time periods, sociodemographic groups (race, sex, etc.). interested consolidating samples age group, use age_standardize() instead. Additionally, plan age-standardization along aggregating groups, always aggregate groups first age-standardization ensure samples properly standardized.","code":""},{"path":"/reference/aggregate_samples.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Aggregate samples by non-age group — aggregate_samples","text":"","code":"pop <- miheart$n[1:2, 1:3, 1:3] time_margin <- 3 # calculate prevalence by aggregating over time periods samples_3564 <- aggregate_samples(minsample, pop, margin = time_margin) # calculate prevalence of only the first two time periods samples_3554 <- aggregate_samples(minsample, pop, time_margin, groups = 1:2) # bind prevalence samples to original samples samples_prev <- aggregate_samples(   minsample,   pop,   time_margin,   bind_new = TRUE,   new_name = \"1979-1981\" )"},{"path":"/reference/generate_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate count data for RSTr object — generate_data","title":"Generate count data for RSTr object — generate_data","text":"generate_data() converts long table featuring event counts across regions optional margins list readable *car().","code":""},{"path":"/reference/generate_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate count data for RSTr object — generate_data","text":"","code":"generate_data(table, event, population, region, group = NULL, time = NULL)"},{"path":"/reference/generate_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate count data for RSTr object — generate_data","text":"table table containing event mortality counts stratified group/region/time. event column containing event counts. population column containing population counts. region column containing region names. group optional column containing sociodemographic group names. time optional column containing time period names.","code":""},{"path":"/reference/generate_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate count data for RSTr object — generate_data","text":"list mortality population counts organized multi-dimensional arrays.","code":""},{"path":"/reference/generate_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate count data for RSTr object — generate_data","text":"generate_data() sum along group/time stratifications specified; example, dataset contains time periods time specified generate_data(), output sum time periods. Filter data desired groups time periods running generate_data().","code":""},{"path":"/reference/generate_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate count data for RSTr object — generate_data","text":"","code":"ma_data <- maexample[!is.na(maexample$Year), ] # Generates data from 1979-1981 stratified by sex ma_data_mst <- generate_data(ma_data, Deaths, Population, County.Code, Sex.Code, Year.Code) ma_data_79 <- ma_data[ma_data$Year == 1979, ] # Generates 1979 data stratified by sex ma_data_m <- generate_data(ma_data_79, Deaths, Population, County.Code, Sex.Code) # Generates 1979 data summarized for all sexes ma_data_u <- generate_data(ma_data_79, Deaths, Population, County.Code)"},{"path":"/reference/get_estimates.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract estimates from RSTr model object — get_estimates","title":"Extract estimates from RSTr model object — get_estimates","text":"Gathers model estimate information RSTr model object, exported long table. Estimate rates respective credible intervals displayed default rates per 100,000.","code":""},{"path":"/reference/get_estimates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract estimates from RSTr model object — get_estimates","text":"","code":"get_estimates(RSTr_obj, rates_per = 1e+05, standardized = TRUE)"},{"path":"/reference/get_estimates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract estimates from RSTr model object — get_estimates","text":"RSTr_obj RSTr model object. rates_per desired scaling estimate rates. standardized RSTr_obj contains age-standardized rates, shows age-standardized rates. set FALSE, always shows non-age-standardized rates.","code":""},{"path":"/reference/get_estimates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract estimates from RSTr model object — get_estimates","text":"long table containing region/group/time period names, estimates, credible intervals, relative precisions, associated event/population counts.","code":""},{"path":"/reference/get_estimates.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract estimates from RSTr model object — get_estimates","text":"","code":"std_pop <- c(113154, 100640, 95799) data_min <- lapply(miheart, \\(x) x[1:2, 1:3, 1:3]) adj_min <- list(2, 1) mod_mst <- mstcar(\"test\", data_min, adj_min, tempdir(), show_plots = FALSE, verbose = FALSE) estimates_table <- get_estimates(mod_mst) mod_mst <- age_standardize(mod_mst, std_pop, \"35-64\") estimates_table_as <- get_estimates(mod_mst)"},{"path":"/reference/get_medians.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate medians, credible intervals, and relative precisions — get_medians","title":"Generate medians, credible intervals, and relative precisions — get_medians","text":"get_medians() generates median estimates array samples loaded load_samples(). get_credible_interval() generates credible interval estimate using samples loaded load_samples(). get_relative_precision() generates relative precision estimate using samples loaded load_samples(). relative precision estimate defined ratio estimate's median divided width credible interval.","code":""},{"path":"/reference/get_medians.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate medians, credible intervals, and relative precisions — get_medians","text":"","code":"get_medians(sample)  get_credible_interval(sample, perc_ci = 0.95)  get_relative_precision(medians, credible_interval)"},{"path":"/reference/get_medians.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate medians, credible intervals, and relative precisions — get_medians","text":"sample array samples generated load_samples. perc_ci Number 0 1. Determines width credible interval. medians Array medians generated samples. credible_interval Credible interval generated get_credible_interval().","code":""},{"path":"/reference/get_medians.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate medians, credible intervals, and relative precisions — get_medians","text":"array estimates/credible intervals/relative precisions.","code":""},{"path":"/reference/get_medians.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate medians, credible intervals, and relative precisions — get_medians","text":"","code":"minmedians <- get_medians(minsample) minci <- get_credible_interval(minsample) # Reducing perc_ci narrows the credible interval minci_75 <- get_credible_interval(minsample, perc_ci = 0.75) # low relative precision due to small data size minrp <- get_relative_precision(minmedians, minci) # reducing CI increases relative precision minrp_75 <- get_relative_precision(minmedians, minci_75) # find estimates with low relative precision low_rp <- minrp_75 < 1"},{"path":"/reference/load_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Load model — load_model","title":"Load model — load_model","text":"load_model() imports RSTr object name name directory dir.","code":""},{"path":"/reference/load_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load model — load_model","text":"","code":"load_model(name, dir = tempdir())"},{"path":"/reference/load_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load model — load_model","text":"name name model load. dir directory model lives.","code":""},{"path":"/reference/load_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load model — load_model","text":"RSTr model object.","code":""},{"path":"/reference/load_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Load model — load_model","text":"","code":"data_min <- lapply(miheart, \\(x) x[1:2, 1:3, 1:3]) adj_min <- list(2, 1) mod_mst <- mstcar(\"test\", data_min, adj_min, tempdir(), show_plots = FALSE, verbose = FALSE) mod_mst <- load_model(name = \"test\", dir = tempdir())"},{"path":"/reference/load_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Load MCMC samples — load_samples","title":"Load MCMC samples — load_samples","text":"load_samples() gathers samples saved model RSTr_obj. default, loads rate estimate samples lambda, model parameters can loaded. Users can also specify burn-period.","code":""},{"path":"/reference/load_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load MCMC samples — load_samples","text":"","code":"load_samples(RSTr_obj, param = \"lambda\", burn = 2000)"},{"path":"/reference/load_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load MCMC samples — load_samples","text":"RSTr_obj RSTr model object load samples . param parameter samples load. burn Number burn-samples discard.","code":""},{"path":"/reference/load_samples.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load MCMC samples — load_samples","text":"array samples model RSTr_obj.","code":""},{"path":"/reference/load_samples.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Load MCMC samples — load_samples","text":"","code":"data_min <- lapply(miheart, \\(x) x[1:2, 1:3, 1:3]) adj_min <- list(2, 1) mod_mst <- mstcar(\"test\", data_min, adj_min, tempdir(), show_plots = FALSE, verbose = FALSE) samples <- load_samples(mod_mst) * 1e5"},{"path":"/reference/maexample.html","id":null,"dir":"Reference","previous_headings":"","what":"Massachusetts Heart Attack Mortality Data — maexample","title":"Massachusetts Heart Attack Mortality Data — maexample","text":"example dataset CDC WONDER containing counts Myocardial Infarction (ICD-9 code 410.0) deaths 14 Massachusetts counties individuals 2 sex groups across 3 years.","code":""},{"path":"/reference/maexample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Massachusetts Heart Attack Mortality Data — maexample","text":"","code":"maexample"},{"path":"/reference/maexample.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Massachusetts Heart Attack Mortality Data — maexample","text":"`maexample` data frame 117 rows 10 variables: Notes Dataset notes, starts line 85 Year Year label Year.Code Year label County County name County.Code County FIPS code Sex Sex group Sex Abbreviated sex group Deaths Death count Population Population count Crude.Rate Crude rate generated death population count","code":""},{"path":"/reference/maexample.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Massachusetts Heart Attack Mortality Data — maexample","text":"<https://wonder.cdc.gov/cmf-icd9.html>","code":""},{"path":"/reference/mamap.html","id":null,"dir":"Reference","previous_headings":"","what":"Massachusetts Shapefile — mamap","title":"Massachusetts Shapefile — mamap","text":"dataset containing U.S. Census TIGER shape data Massachusetts","code":""},{"path":"/reference/mamap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Massachusetts Shapefile — mamap","text":"","code":"mamap"},{"path":"/reference/mamap.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Massachusetts Shapefile — mamap","text":"`mamap` data frame 14 rows 13 variables: STATEFP State FIPS code COUNTYFP County FIPS code COUNTYNS County GNIS code AFFGEOID Census Unique Identifier GEOID Census Unique Identifier, truncated NAME County Name NAMELSAD County LSAD code STUSPS Abbreviated State Name STATE_NAME State Name LSAD State LSAD code ALAND amount land square meters AWATER amount water square meters geometry shape data county","code":""},{"path":"/reference/mamap.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Massachusetts Shapefile — mamap","text":"<https://www.census.gov/geographies/mapping-files/time-series/geo/tiger-line-file.html>","code":""},{"path":"/reference/miadj.html","id":null,"dir":"Reference","previous_headings":"","what":"Michigan Adjacency Data — miadj","title":"Michigan Adjacency Data — miadj","text":"dataset containing adjacency structure county Michigan","code":""},{"path":"/reference/miadj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Michigan Adjacency Data — miadj","text":"","code":"miadj"},{"path":"/reference/miadj.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Michigan Adjacency Data — miadj","text":"`miadj` list containing neighbor adjacency vectors.","code":""},{"path":"/reference/miheart.html","id":null,"dir":"Reference","previous_headings":"","what":"Michigan Heart Attack Mortality Data — miheart","title":"Michigan Heart Attack Mortality Data — miheart","text":"dataset containing counts Myocardial Infarction (ICD-9 code 410.0) deaths 83 Michigan counties individuals 6 age groups across 10 years. dataset also contains corresponding population counts.","code":""},{"path":"/reference/miheart.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Michigan Heart Attack Mortality Data — miheart","text":"","code":"miheart"},{"path":"/reference/miheart.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Michigan Heart Attack Mortality Data — miheart","text":"`miheart` list two array objects: Y death count (0-1005) n population count (26-292828)","code":""},{"path":"/reference/miheart.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Michigan Heart Attack Mortality Data — miheart","text":"<https://wonder.cdc.gov/cmf-icd9.html>","code":""},{"path":"/reference/minsample.html","id":null,"dir":"Reference","previous_headings":"","what":"Samples Generated for Michigan data — minsample","title":"Samples Generated for Michigan data — minsample","text":"4-dimensional array samples generated MSTCAR Gibbs sampler use testing examples","code":""},{"path":"/reference/minsample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Samples Generated for Michigan data — minsample","text":"","code":"minsample"},{"path":"/reference/minsample.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Samples Generated for Michigan data — minsample","text":"`minsample` small sample dataset used examples, generated MSTCAR model two regions, three age groups, three time periods.","code":""},{"path":"/reference/mishp.html","id":null,"dir":"Reference","previous_headings":"","what":"Michigan Shapefile — mishp","title":"Michigan Shapefile — mishp","text":"dataset containing U.S. Census TIGER shape data Michigan","code":""},{"path":"/reference/mishp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Michigan Shapefile — mishp","text":"","code":"mishp"},{"path":"/reference/mishp.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Michigan Shapefile — mishp","text":"`mishp` data frame 83 rows 13 variables: STATEFP State FIPS code COUNTYFP County FIPS code COUNTYNS County GNIS code AFFGEOID Census Unique Identifier GEOID Census Unique Identifier, truncated NAME County Name NAMELSAD County LSAD code STUSPS Abbreviated State Name STATE_NAME State Name LSAD State LSAD code ALAND amount land square meters AWATER amount water square meters geometry shape data county","code":""},{"path":"/reference/mishp.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Michigan Shapefile — mishp","text":"<https://www.census.gov/geographies/mapping-files/time-series/geo/tiger-line-file.html>","code":""},{"path":"/reference/standardize_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Age-standardize samples — standardize_samples","title":"Age-standardize samples — standardize_samples","text":"Age-standardizes samples using standard population.","code":""},{"path":"/reference/standardize_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Age-standardize samples — standardize_samples","text":"","code":"standardize_samples(   sample,   std_pop,   margin,   groups = NULL,   bind_new = FALSE,   new_name = NULL )"},{"path":"/reference/standardize_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Age-standardize samples — standardize_samples","text":"sample array samples imported load_samples() std_pop vector standard populations. margin arrays, margin groups interest stratified. groups vector either indices group vector strings group name. set NULL, use groups dataset. bind_new set TRUE, bind array original sample dataset. Otherwise, generate standalone array samples. new_name name assign age-standardized group.","code":""},{"path":"/reference/standardize_samples.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Age-standardize samples — standardize_samples","text":"array age-standardized samples.","code":""},{"path":"/reference/standardize_samples.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Age-standardize samples — standardize_samples","text":"","code":"std_pop <- c(113154, 100640, 95799) age_margin <- 2 # age-standardize by all age groups samples_3564 <- standardize_samples(minsample, std_pop, age_margin) # age-standardize only by the first two age groups samples_3554 <- standardize_samples(minsample, std_pop[1:2], age_margin, groups = 1:2) # bind age-standardized samples to original samples samples_as <- standardize_samples(   minsample,   std_pop,   age_margin,   bind_new = TRUE,   new_name = \"35-64\" )"},{"path":"/reference/suppress_estimates.html","id":null,"dir":"Reference","previous_headings":"","what":"Suppress estimates based on reliability criteria — suppress_estimates","title":"Suppress estimates based on reliability criteria — suppress_estimates","text":"Generates suppressed estimates RSTr model object given relative precision population/event threshold.","code":""},{"path":"/reference/suppress_estimates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Suppress estimates based on reliability criteria — suppress_estimates","text":"","code":"suppress_estimates(RSTr_obj, threshold = 0, type = c(\"population\", \"event\"))"},{"path":"/reference/suppress_estimates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Suppress estimates based on reliability criteria — suppress_estimates","text":"RSTr_obj RSTr model object. threshold population/event suppression threshold. type Determines whether suppression threshold based population counts event counts.","code":""},{"path":"/reference/suppress_estimates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Suppress estimates based on reliability criteria — suppress_estimates","text":"RSTr model object suppressed estimates.","code":""},{"path":"/reference/suppress_estimates.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Suppress estimates based on reliability criteria — suppress_estimates","text":"threshold argument optional, population/event thresholds necessary non-enhanced models. Population/event thresholds omitted enhanced CAR models, EUCAR.","code":""},{"path":"/reference/suppress_estimates.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Suppress estimates based on reliability criteria — suppress_estimates","text":"","code":"std_pop <- c(113154, 100640, 95799) data_min <- lapply(miheart, \\(x) x[1:2, 1:3, 1:3]) adj_min <- list(2, 1) mod_mst <- mstcar(\"test\", data_min, adj_min, tempdir(), show_plots = FALSE, verbose = FALSE) estimates_table <- get_estimates(mod_mst) mod_mst <- age_standardize(mod_mst, std_pop, \"35-64\") estimates_table_as <- get_estimates(mod_mst)"},{"path":"/reference/ucar.html","id":null,"dir":"Reference","previous_headings":"","what":"Create CAR model — ucar","title":"Create CAR model — ucar","text":"*car() generates RSTr model object, samples, estimates either MSTCAR, MCAR, EUCAR, UCAR model.","code":""},{"path":"/reference/ucar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create CAR model — ucar","text":"","code":"ucar(   name,   data,   adjacency,   dir = tempdir(),   seed = NULL,   perc_ci = 0.95,   iterations = 6000,   show_plots = TRUE,   verbose = TRUE,   ignore_checks = FALSE,   method = c(\"binomial\", \"poisson\"),   impute_lb = NULL,   impute_ub = NULL,   initial_values = NULL,   priors = NULL )  eucar(   name,   data,   adjacency,   dir = tempdir(),   seed = NULL,   perc_ci = 0.95,   A = NULL,   m0 = NULL,   iterations = 6000,   show_plots = TRUE,   verbose = TRUE,   ignore_checks = FALSE,   method = c(\"binomial\", \"poisson\"),   impute_lb = NULL,   impute_ub = NULL,   initial_values = NULL,   priors = NULL )  mcar(   name,   data,   adjacency,   dir = tempdir(),   seed = NULL,   perc_ci = 0.95,   iterations = 6000,   show_plots = TRUE,   verbose = TRUE,   ignore_checks = FALSE,   method = c(\"binomial\", \"poisson\"),   impute_lb = NULL,   impute_ub = NULL,   initial_values = NULL,   priors = NULL )  mstcar(   name,   data,   adjacency,   dir = tempdir(),   seed = NULL,   perc_ci = 0.95,   iterations = 6000,   show_plots = TRUE,   verbose = TRUE,   ignore_checks = FALSE,   method = c(\"binomial\", \"poisson\"),   impute_lb = NULL,   impute_ub = NULL,   initial_values = NULL,   priors = NULL,   update_rho = FALSE )"},{"path":"/reference/ucar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create CAR model — ucar","text":"name Name model corresponding folder. data Dataset including mortality (Y) population (n) information. adjacency Dataset including adjacency information. dir Directory model live. seed Set random seeds use data replication. perc_ci percentage desired estimate credible interval. Defaults 95 percent (0.95). iterations number iterations run model . show_plots set FALSE, suppresses traceplots. verbose set FALSE, suppresses model progress messages. ignore_checks set TRUE, skips model validation. method Run model either Binomial data Poisson data. impute_lb counts suppressed privacy reasons, impute_lb lower bound suppression, typically 0 1. impute_ub counts suppressed privacy reasons, impute_ub upper bound suppression, typically 10. initial_values Optional list initial conditions parameter. priors Optional list priors updates. EUCAR models, describes maximum intensity smoothing regions. m0 EUCAR models, baseline neighbor count region. update_rho MSTCAR models, controls whether rho update performed.","code":""},{"path":"/reference/ucar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create CAR model — ucar","text":"RSTr model object.","code":""},{"path":"/reference/ucar.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create CAR model — ucar","text":"","code":"data_min <- lapply(miheart, \\(x) x[1:2, 1:3, 1:3]) adj_min <- list(2, 1) # MSTCAR model mod_mst <- mstcar(   name = \"test\",   data = data_min,   adjacency = adj_min,   dir = tempdir(),   show_plots = FALSE,   verbose = FALSE )"},{"path":"/reference/update_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Update model — update_model","title":"Update model — update_model","text":"update_model() generates additional samples model RSTr_obj.","code":""},{"path":"/reference/update_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update model — update_model","text":"","code":"update_model(RSTr_obj, iterations = 6000, show_plots = TRUE, verbose = TRUE)"},{"path":"/reference/update_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update model — update_model","text":"RSTr_obj RSTr model object generate samples . iterations Number iterations run. show_plots set FALSE, hides traceplots. verbose set FALSE, hides progress bar messages.","code":""},{"path":"/reference/update_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Update model — update_model","text":"RSTr model object.","code":""},{"path":"/reference/update_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Update model — update_model","text":"","code":"data_min <- lapply(miheart, \\(x) x[1:2, 1:3, 1:3]) adj_min <- list(2, 1) mod_mst <- mstcar(\"test\", data_min, adj_min, tempdir(), show_plots = FALSE, verbose = FALSE) mod_mst <- update_model(mod_mst, iterations = 1000, show_plots = FALSE, verbose = FALSE)"}]
